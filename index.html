<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plantilla de Planeamiento Didáctico - PNFT 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ===== VARIABLES Y RESET ===== */
        :root {
            --primary-color: #45258F;
            --secondary-color: #6c47c9;
            --light-purple: #f0ebf9;
            --border-color: #dee2e6;
            --text-color: #333;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --container-width: 11.5in;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif !important;
        }

        /* ===== TIPOGRAFÍA GLOBAL ===== */
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 20px;
            line-height: 1.5;
            background-color: #f8f9fa;
            color: var(--text-color);
            font-size: 14px;
        }

        /* ===== CONTENEDOR PRINCIPAL ===== */
        .container {
            width: var(--container-width);
            min-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 35px;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1);
        }

        /* ===== ENCABEZADO ===== */
        .header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 4px solid var(--primary-color);
            padding-bottom: 25px;
        }

        .header h1 {
            margin: 8px 0;
            font-size: 24px;
            color: var(--primary-color);
            font-weight: 700;
        }

        .header h2 {
            margin: 8px 0;
            font-size: 18px;
            color: var(--secondary-color);
            font-weight: 500;
        }

        .year {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* ===== TABLAS MEJORADAS ===== */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        td {
            border: 1px solid var(--border-color);
            padding: 12px;
            vertical-align: top;
        }

        /* ===== SECCIONES Y TÍTULOS ===== */
        .section-title {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-weight: 600;
            text-align: center;
            padding: 12px 20px;
            margin: 15px 0;
            border-radius: 8px;
            font-size: 15px;
            box-shadow: 0 2px 8px rgba(69, 37, 143, 0.3);
        }

        /* ===== FORMULARIOS MEJORADAS ===== */
        .input-field, .select-field, .textarea-field {
            width: 100%;
            border: 2px solid var(--border-color);
            outline: none;
            font-size: 14px;
            padding: 10px 14px;
            border-radius: 6px;
            transition: all 0.3s ease;
            background: white;
            font-family: 'Poppins', sans-serif;
        }

        .input-field:focus, .select-field:focus, .textarea-field:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(69, 37, 143, 0.1);
            transform: translateY(-1px);
        }

        .small-input {
            width: 120px;
            padding: 8px 10px;
        }

        .textarea-field {
            resize: vertical;
            min-height: 80px;
            line-height: 1.4;
            font-family: 'Poppins', sans-serif;
        }

        .full-width {
            width: 100%;
        }

        /* ===== CHECKBOXES Y RADIOS MEJORADAS ===== */
        .checkbox-group {
            margin: 8px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        input[type="checkbox"], input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.1);
        }

        label {
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            padding: 5px 0;
            font-family: 'Poppins', sans-serif;
        }

        /* ===== ÁREAS DE CONOCIMIENTO ===== */
        .areas-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .areas-options label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
            transition: background-color 0.3s ease;
        }

        .areas-options label:hover {
            background: var(--light-purple);
        }

        /* ===== RDA CONTAINER MEJORADO ===== */
        .rda-container {
            min-height: 180px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
        }

        .rda-item {
            padding: 15px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
            line-height: 1.6;
            background: white;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            font-family: 'Poppins', sans-serif;
            page-break-inside: avoid;
        }

        .rda-item strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        .rda-divider {
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
            margin: 15px 0;
            opacity: 0.5;
        }

        /* ===== SABERES CONCEPTUALES - MEJORA IMPLEMENTADA ===== */
        .saberes-info {
            padding: 25px;
            text-align: center;
            color: #666;
            font-style: italic;
            background: var(--light-purple);
            border-radius: 8px;
            margin: 15px 0;
        }

        .saberes-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 500px;
            overflow-y: auto;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .saberes-options label {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 13px;
            line-height: 1.4;
            padding: 8px 12px;
            background: white;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .saberes-options label:hover {
            background: var(--light-purple);
            transform: translateX(5px);
        }

        .saber-item {
            display: block;
            margin: 6px 0;
            padding: 10px 14px;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-size: 13px;
            background: white;
            border: 1px solid var(--border-color);
        }

        .saber-item:hover {
            background: var(--light-purple);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(69, 37, 143, 0.1);
        }

        .saber-item input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 2px;
        }

        .area-saberes {
            margin-bottom: 20px;
            padding: 20px;
            border-left: 4px solid var(--primary-color);
            background: linear-gradient(135deg, #f8f9fa, white);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .area-saberes strong {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 15px;
            display: block;
            margin-bottom: 10px;
        }

        /* ===== CONTENEDOR DE SABERES SELECCIONADOS - NUEVO ===== */
        .saberes-seleccionados-container {
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            border: 2px dashed var(--primary-color);
            margin: 15px 0;
        }

        .saberes-seleccionados-lista {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .saber-seleccionado-item {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(69, 37, 143, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .saber-seleccionado-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(69, 37, 143, 0.4);
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
        }

        .saber-seleccionado-item .eliminar {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .saber-seleccionado-item .eliminar:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .contador-saberes {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-top: 10px;
            font-style: italic;
        }

        /* ===== SISTEMA DE SEMANAS MEJORADO ===== */
        .semanas-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: var(--light-purple);
            border-radius: 10px;
            border: 2px dashed var(--primary-color);
        }

        .semanas-controls strong {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 16px;
        }

        .semana-item {
            border: 3px solid var(--primary-color);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #f8f9fa, white);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            width: 100%;
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .semana-item:hover {
            box-shadow: 0 6px 20px rgba(69, 37, 143, 0.15);
            transform: translateY(-2px);
        }

        .semana-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
            flex-shrink: 0;
        }

        .semana-header strong {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 16px;
        }

        .semana-nombre {
            width: 200px !important;
            font-weight: 500;
            color: var(--primary-color);
        }

        /* MEJORA 2: OCULTAR LECCIONES - ELIMINADO EL ESTILO .lecciones-info */
        .lecciones-info {
            display: none; /* MEJORA 2: Se oculta completamente */
        }

        .semana-content {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
            flex: 1;
            min-height: 300px;
        }

        .semana-col {
            display: flex;
            flex-direction: column;
            min-height: 300px;
            position: relative;
        }

        .semana-col-title {
            background: var(--primary-color);
            color: white;
            padding: 10px;
            text-align: center;
            border-radius: 6px;
            margin-bottom: 10px;
            font-weight: 600;
            flex-shrink: 0;
            position: relative;
        }

        /* ===== SOLUCIÓN DEFINITIVA: CONTENEDORES EDITABLES ===== */
        .contenedor-editable {
            flex: 1;
            min-height: 150px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            padding: 12px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            line-height: 1.4;
            background: white;
            overflow-y: auto;
            resize: vertical;
            transition: all 0.3s ease;
            outline: none;
        }

        .contenedor-editable:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(69, 37, 143, 0.1);
        }

        .contenedor-editable[contenteditable="true"]:empty:before {
            content: attr(data-placeholder);
            color: #999;
            font-style: italic;
        }

        .expand-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 255, 255, 0.3);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 12px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .expand-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }

        /* MEJORA 1: SABERES SEMANA ARRIBA DE TODO */
        .saberes-semana-container {
            margin-bottom: 25px; /* MEJORA 1: Ahora va antes del contenido de la semana */
            padding: 25px;
            background: white;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            min-height: 250px;
            flex-shrink: 0;
        }

        .saberes-semana-opciones {
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        /* ===== BOTONES MEJORADOS ===== */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 3px solid var(--light-purple);
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Poppins', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: 0 4px 12px rgba(69, 37, 143, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(69, 37, 143, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #545b62);
            color: white;
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--light-purple);
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(69, 37, 143, 0.2);
        }

        .copilot-btn {
            background: linear-gradient(135deg, #0078d4, #106ebe);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-top: 10px;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0, 120, 212, 0.3);
            font-family: 'Poppins', sans-serif;
        }

        .copilot-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 120, 212, 0.4);
        }

        .btn-agregar-semana {
            background: linear-gradient(135deg, var(--success-color), #218838);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
            font-family: 'Poppins', sans-serif;
        }

        .btn-agregar-semana:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
        }

        .btn-eliminar-semana {
            background: linear-gradient(135deg, var(--danger-color), #c82333);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(220, 53, 69, 0.3);
        }

        .btn-eliminar-semana:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
        }

        /* ===== SABERES MANUALES ===== */
        .saberes-manuales-container {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-radius: 10px;
            border: 2px dashed var(--warning-color);
        }

        .saberes-manuales-input {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid var(--warning-color);
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
            background: white;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .saberes-manuales-input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 193, 7, 0.1);
        }

        .saberes-manuales-lista {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            max-height: 200px;
            overflow-y: auto;
        }

        /* ===== FOOTER ===== */
        .footer {
            text-align: center;
            margin-top: 30px;
            font-weight: bold;
            color: var(--primary-color);
            padding: 25px;
            border-top: 3px solid var(--primary-color);
            background: var(--light-purple);
            border-radius: 8px;
        }

        /* ===== UTILIDADES ===== */
        small {
            color: #666;
            font-size: 12px;
            display: block;
            margin-top: 8px;
        }

        /* ===== MODAL PARA GUARDADO MEJORADO ===== */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .plan-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px;
        }

        .plan-item {
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary-color);
        }

        .plan-item:hover {
            background: var(--light-purple);
            transform: translateX(5px);
        }

        .plan-item.selected {
            background: var(--light-purple);
            border-left-color: var(--success-color);
        }

        .plan-details {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 12px;
            color: #666;
        }

        /* ===== EJES TRANSVERSALES MULTIPLES MEJORADOS ===== */
        .ejes-transversales {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .eje-option {
            padding: 15px;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .eje-option:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .eje-option.selected {
            border-color: var(--primary-color);
            background: var(--light-purple);
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 1200px) {
            .container {
                width: 95%;
                min-width: auto;
                padding: 25px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .semana-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .semanas-controls {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .ejes-transversales {
                grid-template-columns: 1fr;
            }
            
            .semana-content {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        /* ===== IMPRESIÓN OPTIMIZADA - SOLUCIÓN DEFINITIVA MEJORADA ===== */
        @media print {
            body {
                background: white !important;
                padding: 0 !important;
                margin: 0 !important;
                font-size: 12px !important;
                font-family: 'Poppins', sans-serif !important;
                line-height: 1.4 !important;
                color: black !important;
            }
            
            .container {
                width: 100% !important;
                max-width: 100% !important;
                min-width: auto !important;
                box-shadow: none !important;
                padding: 10px !important;
                margin: 0 !important;
                border: none !important;
                border-radius: 0 !important;
            }
            
            /* Ocultar elementos no necesarios en impresión */
            .action-buttons, 
            .copilot-btn, 
            .btn-agregar-semana, 
            .btn-eliminar-semana,
            .modal,
            .semanas-controls,
            .btn,
            .expand-btn {
                display: none !important;
            }
            
            /* Semanas - mantener estructura pero optimizar para impresión */
            .semana-item {
                border: 1px solid #000 !important;
                page-break-inside: avoid !important;
                margin-bottom: 15px !important;
                padding: 15px !important;
                break-inside: avoid !important;
                box-shadow: none !important;
                background: white !important;
                min-height: auto !important;
                max-height: none !important;
                height: auto !important;
            }
            
            /* Mantener estructura de 3 columnas en impresión */
            .semana-content {
                display: grid !important;
                grid-template-columns: 1fr 1fr 1fr !important;
                gap: 8px !important;
                page-break-inside: avoid !important;
                margin-bottom: 10px !important;
            }
            
            .semana-col {
                margin-bottom: 0 !important;
                page-break-inside: avoid !important;
                min-height: auto !important;
                break-inside: avoid !important;
                height: auto !important;
            }
            
            .semana-col-title {
                background: #f0f0f0 !important;
                color: black !important;
                border: 1px solid #ccc !important;
                margin-bottom: 5px !important;
                font-size: 11px !important;
                padding: 6px !important;
            }
            
            /* ===== SOLUCIÓN DEFINITIVA MEJORADA: CONTENEDORES EDITABLES EN IMPRESIÓN ===== */
            .contenedor-editable {
                /* ELIMINAR TODAS LAS RESTRICCIONES */
                min-height: auto !important;
                height: auto !important;
                max-height: none !important;
                
                /* PERMITIR EXPANSIÓN COMPLETA */
                overflow: visible !important;
                overflow-y: visible !important;
                overflow-x: visible !important;
                
                /* GARANTIZAR VISIBILIDAD */
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                
                /* FORMATO DE TEXTO COMPLETO - MEJORADO PARA BULLETS */
                white-space: pre-wrap !important;
                white-space: -moz-pre-wrap !important;
                white-space: -pre-wrap !important;
                white-space: -o-pre-wrap !important;
                word-wrap: break-word !important;
                word-break: break-word !important;
                overflow-wrap: break-word !important;
                
                /* ESTILOS DE IMPRESIÓN MEJORADOS */
                font-size: 11px !important;
                line-height: 1.3 !important;
                border: 1px solid #ccc !important;
                background: white !important;
                padding: 8px !important;
                
                /* EXPANSIÓN NATURAL */
                page-break-inside: auto !important;
                break-inside: auto !important;
                
                /* ELIMINAR SCROLL Y RESIZE */
                resize: none !important;
                
                /* CONTENEDOR FLEXIBLE */
                display: block !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }

            /* Estilos específicos para listas y bullets en impresión */
            .contenedor-editable ul,
            .contenedor-editable ol {
                margin: 3px 0 !important;
                padding-left: 15px !important;
            }

            .contenedor-editable li {
                margin-bottom: 2px !important;
                page-break-inside: avoid !important;
                line-height: 1.2 !important;
            }

            /* Asegurar que NO haya límites de altura en las columnas */
            .semana-col {
                height: auto !important;
                min-height: auto !important;
                max-height: none !important;
            }

            /* Permitir que el contenido fluya naturalmente */
            .semana-item {
                height: auto !important;
                min-height: auto !important;
            }

            /* ===== CHECKBOXES VISIBLES ===== */
            input[type="checkbox"] {
                display: none !important;
            }
            
            .saberes-options input[type="checkbox"]:checked + span::before,
            .checkbox-group input[type="checkbox"]:checked + span::before,
            .eje-option input[type="checkbox"]:checked + span::before,
            .saber-item input[type="checkbox"]:checked + span::before {
                content: "✓ " !important;
                font-weight: bold !important;
                color: black !important;
                margin-right: 5px !important;
            }
            
            .saberes-options input[type="checkbox"]:checked + span,
            .checkbox-group input[type="checkbox"]:checked + span,
            .eje-option input[type="checkbox"]:checked + span,
            .saber-item input[type="checkbox"]:checked + span {
                background: #f0f0f0 !important;
                padding: 2px 4px !important;
                border-radius: 2px !important;
                display: inline-block !important;
            }
            
            .saberes-options label,
            .checkbox-group label {
                display: block !important;
                margin-bottom: 2px !important;
                font-size: 11px !important;
            }
            
            /* RdA - asegurar que no se corte */
            .rda-container {
                min-height: auto !important;
                max-height: none !important;
                overflow: visible !important;
                border: 1px solid #ccc !important;
                background: white !important;
                page-break-inside: avoid !important;
                padding: 8px !important;
            }
            
            .rda-item {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
                margin-bottom: 8px !important;
                border: 1px solid #eee !important;
                font-size: 11px !important;
                padding: 8px !important;
            }
            
            /* MEJORA 3: OCULTAR LISTA COMPLETA DE SABERES EN IMPRESIÓN */
            .saberes-semana-opciones,
            .saberes-options,
            .saberes-semana-container .section-title:first-child {
                display: none !important;
            }

            /* MANTENER VISIBLES los saberes procedimentales y actitudinales */
            .saberes-options {
                display: block !important;
                max-height: none !important;
                overflow: visible !important;
            }
            
            /* MEJORA 3: Mostrar solo los saberes seleccionados en impresión */
            .saberes-seleccionados-container {
                display: block !important;
                border: 1px solid #ccc !important;
                background: white !important;
                page-break-inside: avoid !important;
                margin: 10px 0 !important;
                padding: 10px !important;
            }
            
            .saberes-seleccionados-lista {
                display: block !important;
            }
            
            .saber-seleccionado-item {
                background: #f0f0f0 !important;
                color: black !important;
                border: 1px solid #ccc !important;
                margin: 2px !important;
                padding: 3px 8px !important;
                display: inline-block !important;
                font-size: 10px !important;
            }
            
            .saber-seleccionado-item .eliminar {
                display: none !important;
            }
            
            /* Evitar cortes de texto en todos los elementos */
            table, .semana-item, .area-saberes, .rda-item,
            .saberes-semana-container, .semana-col {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            .header {
                page-break-after: avoid !important;
            }
            
            /* Mejorar espaciado para impresión */
            .section-title {
                margin: 8px 0 !important;
                padding: 6px 12px !important;
                background: #f0f0f0 !important;
                color: black !important;
                border: 1px solid #ccc !important;
                font-size: 11px !important;
            }
            
            /* Asegurar que los elementos se muestren correctamente */
            .saber-item {
                border: none !important;
                background: white !important;
                padding: 1px 0 !important;
                font-size: 11px !important;
                display: block !important;
            }
            
            .eje-option {
                border: 1px solid #ccc !important;
                background: white !important;
                margin-bottom: 3px !important;
                padding: 6px !important;
                font-size: 11px !important;
            }
            
            .areas-options label {
                border: none !important;
                background: white !important;
                padding: 1px 0 !important;
                font-size: 11px !important;
            }
            
            .saberes-options label {
                border: none !important;
                background: white !important;
                padding: 1px 0 !important;
                font-size: 11px !important;
            }
            
            /* Footer de impresión */
            .footer {
                border-top: 2px solid #000 !important;
                background: white !important;
                color: black !important;
                margin-top: 15px !important;
                font-size: 11px !important;
                padding: 15px !important;
            }
            
            /* Eliminar efectos visuales */
            .semana-item:hover {
                transform: none !important;
                box-shadow: none !important;
            }
            
            /* Asegurar que las semanas no se corten entre páginas */
            .semana-item {
                break-inside: avoid !important;
                page-break-inside: avoid !important;
            }
            
            /* PERMITIR que las estrategias de mediación se expandan naturalmente */
            .semana-content {
                page-break-inside: avoid !important;
            }
            
            /* Reducir márgenes para optimizar espacio */
            @page {
                margin: 0.3cm;
            }

            /* Optimizar tablas para impresión */
            table {
                margin-bottom: 10px !important;
            }
            
            td {
                padding: 6px !important;
                font-size: 11px !important;
            }
        }

        /* ===== SCROLLBAR PERSONALIZADO ===== */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* ===== COPILOT MODAL ===== */
        .copilot-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
        }

        .copilot-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .copilot-prompt {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 15px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
        }

        .copilot-response {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            min-height: 100px;
            margin-top: 15px;
            font-family: 'Poppins', sans-serif;
        }

        /* ===== INDICADORES DE LOGRO MEJORADOS ===== */
        .indicadores-lista {
            margin: 0;
            padding-left: 20px;
        }

        .indicadores-lista li {
            margin-bottom: 8px;
            line-height: 1.4;
            padding-left: 5px;
        }

        .indicadores-lista li:last-child {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Encabezado -->
        <div class="header">
            <h1 id="titulo-secreto">Plantilla de Planeamiento Didáctico</h1>
            <h2>Programa Nacional de Formación Tecnológica</h2>
            <div class="year">2026</div>
        </div>

        <!-- Información General -->
        <table>
            <tr>
                <td width="33%">
                    <strong>Dirección Regional de Educación:</strong><br>
                    <input type="text" id="direccionRegional" placeholder="" class="input-field">
                </td>
                <td width="33%">
                    <strong>Centro educativo:</strong><br>
                    <input type="text" id="centroEducativo" placeholder="" class="input-field">
                </td>
                <td width="34%">
                    <strong>Código:</strong><br>
                    <input type="text" id="codigoCentro" class="input-field">
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Nombre de la persona docente:</strong><br>
                    <input type="text" id="nombreDocente" class="input-field">
                </td>
                <td colspan="2">
                    <strong>Asignatura: Formación tecnológica/Informática educativa</strong><br>
                    <strong>Curso lectivo:</strong> 2026
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Ciclo:</strong><br>
                    <select id="ciclo" class="select-field">
                        <option value="">Seleccionar</option>
                        <option value="Preescolar">Preescolar</option>
                        <option value="I Ciclo">I Ciclo</option>
                        <option value="II Ciclo">II Ciclo</option>
                        <option value="III Ciclo">III Ciclo</option>
                    </select>
                </td>
                <td>
                    <strong>Nivel:</strong><br>
                    <select id="nivel" class="select-field">
                        <option value="">Seleccionar</option>
                        <option value="Preescolar">Preescolar</option>
                        <option value="1°">1°</option>
                        <option value="2°">2°</option>
                        <option value="3°">3°</option>
                        <option value="4°">4°</option>
                        <option value="5°">5°</option>
                        <option value="6°">6°</option>
                        <option value="7°">7°</option>
                        <option value="8°">8°</option>
                        <option value="9°">9°</option>
                    </select>
                </td>
                <td>
                    <strong>Lecciones planificadas:</strong><br>
                    <input type="number" id="leccionesPlanificadas" min="1" max="40" value="8" class="input-field">
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <strong>Mes inicio:</strong> <input type="text" id="mesInicio" class="small-input">
                    <strong>Mes final:</strong> <input type="text" id="mesFinal" class="small-input">
                    <br>
                    <strong>Periodicidad:</strong>
                    <span class="checkbox-group">
                        <label><input type="radio" name="periodicidad" value="mes"> <span>mes</span></label>
                        <label><input type="radio" name="periodicidad" value="bimestre" checked> <span>bimestre</span></label>
                        <label><input type="radio" name="periodicidad" value="trimestre"> <span>trimestre</span></label>
                        <label><input type="radio" name="periodicidad" value="semestre"> <span>semestre</span></label>
                    </span>
                </td>
            </tr>
        </table>

        <!-- Ejes Transversales Múltiples -->
        <div class="section-title">
            Ejes transversales del PNFT según competencia MEP, marque con equis (x) <strong>todos los ejes</strong> a desarrollar.
        </div>
        <div class="ejes-transversales">
            <div class="eje-option">
                <label>
                    <input type="checkbox" name="eje" value="ciudadania">
                    <span><strong>Ciudadanía y ética digital</strong><br>
                    <small>Competencias para la ciudadanía responsable y solidaria</small></span>
                </label>
            </div>
            <div class="eje-option">
                <label>
                    <input type="checkbox" name="eje" value="pensamiento">
                    <span><strong>Pensamiento computacional para la resolución de problemas</strong><br>
                    <small>Competencias para la vida</small></span>
                </label>
            </div>
            <div class="eje-option">
                <label>
                    <input type="checkbox" name="eje" value="emprendimiento">
                    <span><strong>Emprendimiento e Innovación</strong><br>
                    <small>Competencias para el empleo digno</small></span>
                </label>
            </div>
        </div>

        <!-- Metodología Activa -->
        <div class="section-title">Metodología activa:</div>
        <select id="metodologiaActiva" class="select-field">
            <option value="">Seleccionar metodología</option>
            <option value="ABJ">Aprendizaje basado en juegos (ABJ)</option>
            <option value="ABR">Aprendizaje basado en retos (ABR)</option>
            <option value="design-thinking">Design thinking</option>
            <option value="otra">Otra: Especifique</option>
        </select>
        <input type="text" id="metodologiaOtra" placeholder="Especifique la metodología" class="input-field" style="display: none; margin-top: 5px;">

        <!-- Área de Conocimiento y RdA -->
        <table>
            <tr>
                <td width="50%" class="section-title">Área de conocimiento</td>
                <td width="50%" class="section-title">RdA:</td>
            </tr>
            <tr>
                <td>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="area" value="apropiacion"> <span>Apropiación Tecnológica y Digital</span></label>
                        <label><input type="checkbox" name="area" value="programacion"> <span>Programación y Algoritmos</span></label>
                        <label><input type="checkbox" name="area" value="robotica"> <span>Computación física y Robótica</span></label>
                        <label><input type="checkbox" name="area" value="ciencia"> <span>Ciencia de datos e Inteligencia artificial</span></label>
                    </div>
                </td>
                <td>
                    <div id="rdaContainer" class="rda-container">
                        <div class="saberes-info">Seleccione un nivel y al menos un área de conocimiento</div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Saberes Conceptuales, Procedimentales y Actitudinales -->
        <table class="saberes-table">
            <tr>
                <td width="33%" class="section-title">Saberes conceptuales (saber)</td>
                <td width="33%" class="section-title">Saberes procedimentales (saber hacer)</td>
                <td width="34%" class="section-title">Saberes actitudinales (saber ser)</td>
            </tr>
            <tr>
                <td>
                    <!-- CONTENEDOR MEJORADO: Ahora muestra los saberes seleccionados en tiempo real -->
                    <div id="saberesConceptualesContainer" class="saberes-seleccionados-container">
                        <div class="saberes-info">Saberes conceptuales en cada semana ve abajo en Planificación por semanas</div>
                        <div id="saberesSeleccionadosLista" class="saberes-seleccionados-lista">
                            <!-- Los saberes seleccionados aparecerán aquí dinámicamente -->
                        </div>
                        <div id="contadorSaberes" class="contador-saberes">
                            Total de saberes seleccionados: <span id="totalSaberes">0</span>
                        </div>
                    </div>
                    
                    <!-- Campo para saberes manuales -->
                    <div class="saberes-manuales-container">
                        <strong> Escriba sus saberes conceptuales manualmente:</strong><br>
                        <textarea class="saberes-manuales-input" id="saberesManuales" placeholder="Ej: Hardware; Software; Internet; Redes... (Separe con punto y coma)"></textarea>
                        <small>Separe cada saber con punto y coma (;)</small>
                    </div>
                </td>
                <td>
                    <div class="saberes-options">
                        <label><input type="checkbox" name="procedimental" value="reconoce"> <span>⚠ Reconoce patrones.</span></label>
                        <label><input type="checkbox" name="procedimental" value="abstrae"> <span>⚠ Abstrae.</span></label>
                        <label><input type="checkbox" name="procedimental" value="generaliza"> <span>⚠ Generaliza.</span></label>
                        <label><input type="checkbox" name="procedimental" value="transfiere"> <span>⚠ Transfiere.</span></label>
                        <label><input type="checkbox" name="procedimental" value="modulariza"> <span>⚠ Modulariza.</span></label>
                        <label><input type="checkbox" name="procedimental" value="formula"> <span>⚠ Formula algoritmos.</span></label>
                        <label><input type="checkbox" name="procedimental" value="remezcla"> <span>⚠ Remezcla.</span></label>
                        <label><input type="checkbox" name="procedimental" value="depura"> <span>⚠ Depura.</span></label>
                        <label><input type="checkbox" name="procedimental" value="programa"> <span>⚠ Programa.</span></label>
                        <label><input type="checkbox" name="procedimental" value="comunica"> <span>⚠ Comunica.</span></label>
                        <label><input type="checkbox" name="procedimental" value="colabora"> <span>⚠ Colabora.</span></label>
                        <label><input type="checkbox" name="procedimental" value="piensa"> <span>⚠ Piensa de forma creativa.</span></label>
                        <label><input type="checkbox" name="procedimental" value="maneja"> <span>⚠ Maneja las tecnologías de forma ética y segura.</span></label>
                    </div>
                </td>
                <td>
                    <div class="saberes-options">
                        <label><input type="checkbox" name="actitudinal" value="gusto"> <span>⚠ Gusto por la precisión.</span></label>
                        <label><input type="checkbox" name="actitudinal" value="aprender"> <span>⚠ Aprender del error.</span></label>
                        <label><input type="checkbox" name="actitudinal" value="flexibilidad"> <span>⚠ Flexibilidad para manejar problemas.</span></label>
                        <label><input type="checkbox" name="actitudinal" value="tolerancia"> <span>⚠ Tolerancia a la frustración.</span></label>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Sistema de Semanas Dinámico -->
        <div class="section-title">Planificación por Semanas</div>
        <div class="semanas-controls">
            <div>
                <strong>Lecciones totales: <span id="totalLecciones">8</span></strong> | 
                <strong>Semanas generadas: <span id="totalSemanas">2</span></strong>
            </div>
            <button type="button" class="btn-agregar-semana" onclick="agregarSemanaManual()">+ Agregar Semana</button>
        </div>
        
        <div id="semanasContainer">
            <!-- Las semanas se generarán automáticamente aquí -->
        </div>

        <!-- Reflexiones Docentes -->
        <table>
            <tr>
                <td width="33%" class="section-title">¿Qué funcionó?</td>
                <td width="33%" class="section-title">¿Qué no funcionó?</td>
                <td width="34%" class="section-title">¿Qué puedo mejorar?</td>
            </tr>
            <tr>
                <td><textarea id="queFunciono" class="textarea-field" placeholder="Describa las estrategias que funcionaron bien..."></textarea></td>
                <td><textarea id="queNoFunciono" class="textarea-field" placeholder="Describa las dificultades encontradas..."></textarea></td>
                <td><textarea id="queMejorar" class="textarea-field" placeholder="Describa las mejoras para próximas clases..."></textarea></td>
            </tr>
        </table>

        <!-- Observaciones -->
        <div class="section-title">Observaciones y/o recomendaciones didácticas por nivel:</div>
        <textarea id="observaciones" class="textarea-field full-width" placeholder="Observaciones generales sobre el desarrollo de las clases..."></textarea>

        <!-- Footer -->
        <div class="footer">
            PROGRAMA NACIONAL DE FORMACIÓN TECNOLÓGICA<br>
            Dirección de Recursos Tecnológicos en Educación
            <br>Creado por: Asesor Nacional <strong>MSc. Kevin Sánchez Bogarín</strong>
        </div>

        <!-- Botones de Acción -->
        <div class="action-buttons">
            <button onclick="guardarPlan()" class="btn btn-primary">💾 Guardar Plan</button>
            <button onclick="cargarPlan()" class="btn btn-secondary">📂 Cargar Plan</button>
            <button onclick="exportarPlan()" class="btn btn-outline">💾 Exportar a Archivo</button>
            <button onclick="importarPlan()" class="btn btn-outline">📂 Importar Archivo</button>
            <button onclick="exportarPDF()" class="btn btn-secondary">📄 Exportar a PDF</button>
            <button onclick="nuevoPlan()" class="btn btn-outline">🆕 Nuevo Plan</button>
        </div>
    </div>

    <!-- Modales -->
    <div id="guardarModal" class="modal">
        <div class="modal-content">
            <h3>💾 Guardar Plan</h3>
            <input type="text" id="nombrePlan" placeholder="Ej: 1° Matemáticas - Bimestre 1" class="input-field" style="margin-bottom: 15px;">
            <button onclick="confirmarGuardar()" class="btn btn-primary" style="width: 100%;">✅ Guardar Plan</button>
            <button onclick="cerrarModal()" class="btn btn-outline" style="width: 100%; margin-top: 10px;">❌ Cancelar</button>
        </div>
    </div>

    <div id="cargarModal" class="modal">
        <div class="modal-content">
            <h3>📂 Cargar Plan</h3>
            <div class="plan-list" id="listaPlanes">
                <div class="saberes-info" id="sinPlanesMsg">No hay planes guardados</div>
            </div>
            <button onclick="confirmarCargar()" class="btn btn-primary" style="width: 100%;">✅ Cargar Plan Seleccionado</button>
            <button onclick="cerrarModal()" class="btn btn-outline" style="width: 100%; margin-top: 10px;">❌ Cancelar</button>
        </div>
    </div>

    <script>
        // ===== BASE DE DATOS COMPLETA PNFT =====
        const PNFT_DATA = {
          "Preescolar": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Computadora", indicadores: ["Identificar qué es una computadora y algunas de sus características, a partir de experiencias prácticas de interacción con dispositivos digitales."] },
                { nombre: "Software", indicadores: ["Reconocer elementos visuales básicos de la interfaz de software (iconos, botones, ventanas), interactuando con ellos mediante el uso guiado de dispositivos digitales."] },
                { nombre: "Herramientas de creación de contenido multimedia", indicadores: ["Reconocer las herramientas de creación de contenido multimedia según su utilidad: editor gráfico, grabadora de audio y video, en la creación de recursos digitales."] },
                { nombre: "Hardware", indicadores: ["Reconocer componentes básicos del hardware, como dispositivos de entrada y salida de datos, explorando su función al encender, usar o interactuar con la computadora en actividades cotidianas."] },
                { nombre: "Internet", indicadores: ["Reconocer qué es Internet y los requerimientos de un dispositivo para conectarse a Internet, realizando una exploración dirigida."] },
                { nombre: "Conexión entre dispositivos", indicadores: ["Reconocer la conexión entre dispositivos por bluetooth y los requerimientos de dispositivos digitales para conectarse, a través de una exploración dirigida."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación iconográfico", indicadores: ["Reconocer el entorno de programación iconográfico, interactuando con bloques de la interfaz, como desplazamiento, apariencia o sonido, mediante el uso guiado del docente."] },
                { nombre: "Lateralidad y orientación espacial", indicadores: ["Reconocer los conceptos de lateralidad y orientación espacial en la construcción de secuencias de acciones para la solución de retos de programación."] },
                { nombre: "Evento", indicadores: ["Reconocer que un evento desencadena una acción, identificando la relación de causa y efecto en juegos o actividades."] },
                { nombre: "Estado", indicadores: ["Reconocer el concepto de estado programando objetos que modifican las propiedades de orientación y/o dirección."] },
                { nombre: "Algoritmo", indicadores: ["Reconocer el concepto de algoritmo mediante secuencias de acciones lógicas y ordenadas, en la construcción de soluciones a desafíos propuestos."] },
                { nombre: "Dato", indicadores: ["Reconocer la importancia del dato en contexto físico y en contexto digital mientras soluciona desafíos propuestos."] },
                { nombre: "Estructuras repetitivas", indicadores: ["Reconocer estructuras repetitivas en secuencias de acciones durante la programación guiada de objetos digitales, distinguiendo si una acción se repite un número limitado o ilimitado de veces."] }
              ]
            },
            "Computación física y Robótica": {
              saberes: [
                { nombre: "Robot", indicadores: ["Reconocer qué es un robot, sus componentes y algunos de sus usos, mediante actividades lúdicas de exploración o programación guiada."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Dato", indicadores: ["Identificar el dato y su importancia en situaciones cotidianas, reconociendo diferentes tipos como texto, imagen, sonido o video."] },
                { nombre: "Estrategias para presentar datos", indicadores: ["Reconocer gráficos pictóricos como estrategia para representar datos recolectados en actividades lúdicas."] },
                { nombre: "Visualización de datos", indicadores: ["Interpretar gráficos pictóricos como parte de la visualización de datos (colores, formas, cantidades), con apoyo del docente, relacionándolos con datos conocidos del entorno."] },
                { nombre: "Realidad aumentada", indicadores: ["Experimentar con realidad aumentada en entornos físicos mediante actividades sensoriales y lúdicas, con acompañamiento del docente."] }
              ]
            }
          },
          "1°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Computadora", indicadores: ["Reconocer la computadora como una herramienta tecnológica, identificando sus características básicas, funciones e importancia en la vida cotidiana, por medio de la observación y manipulación práctica."] },
                { nombre: "Hardware", indicadores: ["Identificar el hardware básico de una computadora, reconociendo dispositivos de entrada, salida y las acciones de encendido y apagado, mediante actividades prácticas guiadas."] },
                { nombre: "Software", indicadores: ["Identificar el software de una computadora, reconociendo los elementos básicos de la interfaz de usuario mediante actividades prácticas guiadas."] },
                { nombre: "Conexión entre dispositivos (bluetooth)", indicadores: ["Reconocer el bluetooth como medio de conexión entre dispositivos utilizando dispositivos digitales en el aula."] },
                { nombre: "Herramientas de creación de contenido multimedia (audio, imágenes)", indicadores: ["Utilizar herramientas de creación de contenido multimedia para la creación de audios e incorporación de imágenes en productos digitales."] },
                { nombre: "Internet", indicadores: ["Reconocer los dispositivos y programas que permiten la conexión para la navegación en Internet."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación iconográfico", indicadores: ["Reconocer elementos básicos de un entorno de programación iconográfico, como bloques de desplazamiento, orientación, apariencia, sonido, eventos y control, mediante la navegación en la interfaz con actividades guiadas."] },
                { nombre: "Reconocimiento de patrones", indicadores: ["Reconocer patrones de movimiento en secuencias de instrucciones simples para que un personaje siga una ruta desde un punto de inicio hasta un punto de llegada."] },
                { nombre: "Estado", indicadores: ["Reconocer el estado de un objeto digital en relación con su orientación, dirección y tamaño, identificando variaciones en dichos atributos, mediante secuencias de programaciones simples."] },
                { nombre: "Algoritmo", indicadores: ["Identificar un algoritmo en situaciones de la vida diaria, reconociendo secuencias lógicas y ordenadas de acciones, para ser representadas de forma analógica (dibujos, tarjetas, gestos) y/o digital (entorno iconográfico)."] },
                { nombre: "Dato", indicadores: ["Identificar el dato en situaciones de la vida diaria, reconociendo información valiosa en contextos físicos (como etiquetas, señales, objetos) y digitales (como imágenes, íconos o pantallas interactivas)."] },
                { nombre: "Estructuras repetitivas", indicadores: ["Reconocer estructuras repetitivas al identificar ciclos finitos (como una canción o rutina) e infinitos (como el tic-tac del reloj o el movimiento del ventilador) en situaciones de la vida diaria."] },
                { nombre: "Evento", indicadores: ["Reconocer el evento como relación de causa y efecto al participar en juegos analógicos, identificando cómo una acción provoca una respuesta o cambio observable durante la dinámica."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Fundamentos de la IA", indicadores: ["Reconocer los fundamentos de la inteligencia artificial a través de objetos o situaciones del entorno donde esta tecnología está presente, mediante actividades guiadas con apoyo visual o audiovisual."] },
                { nombre: "Asistentes virtuales", indicadores: ["Reconocer qué es un asistente virtual y sus funciones a partir de demostraciones guiadas o videos educativos."] }
              ]
            }
          },
          "2°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Hardware", indicadores: ["Identificar el funcionamiento de los componentes básicos del hardware, reconociendo cómo cuidarlos mientras utilizan la computadora en la cotidianidad."] },
                { nombre: "Software (programas)", indicadores: ["Explorar el funcionamiento de diferentes programas de software según la tarea escolar asignada durante el trabajo en aula."] },
                { nombre: "Conexión entre dispositivos", indicadores: ["Reconocer el wifi como medio de conexión entre dispositivos conectando dispositivos digitales en el aula."] },
                { nombre: "Herramienta de productividad (procesador de texto)", indicadores: ["Utilizar herramientas de productividad como el procesador de texto, reconociendo la cinta de opciones, pestañas y comandos básicos, así como sus funciones por teclado, durante la creación de textos sencillos."] },
                { nombre: "Herramientas de creación de contenido multimedia (grabadora de audio y editores de gráficos)", indicadores: ["Utilizar herramientas de creación de contenido multimedia, como la grabadora de audio y editores de gráficos, aplicando funciones básicas como crear, editar y guardar archivos, durante actividades guiadas de producción digital en el aula."] },
                { nombre: "Internet", indicadores: ["Aplicar normas básicas de navegación por internet, para acceder a páginas educativas seguras, bajo acompañamiento del docente."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación por bloques", indicadores: ["Aplicar el uso del entorno de programación por bloques, explorando la interfaz y el área de bloques mientras construye secuencias de acciones que representen historias cotidianas."] },
                { nombre: "Algoritmo", indicadores: ["Diseñar un algoritmo en lenguaje natural como una secuencia ordenada que resuelve situaciones de la vida cotidiana."] },
                { nombre: "Dato", indicadores: ["Clasificar el dato como numérico o de texto en ejemplos de la vida cotidiana, valorando su uso en actividades del entorno cercano."] },
                { nombre: "Variable", indicadores: ["Identificar una variable en contextos de la vida cotidiana, observando elementos que cambian en relación con otros (como edad, cantidad, clima o tiempo de actividad)."] },
                { nombre: "Estructuras repetitivas", indicadores: ["Identificar estructuras repetitivas en actividades programadas, diferenciando entre ciclos finitos e infinitos según la cantidad de repeticiones requeridas."] },
                { nombre: "Estructuras condicionales", indicadores: ["Aplicar estructuras condicionales simples en un entorno de programación por bloques en la resolución de un ejercicio programado."] },
                { nombre: "Operadores aritméticos", indicadores: ["Reconocer los operadores aritméticos de suma y resta en situaciones de la vida cotidiana y su uso en un entorno de programación por bloques."] },
                { nombre: "Operador relacional", indicadores: ["Reconocer el operador relacional \"igual que\" en situaciones de la vida cotidiana y su uso en un entorno de programación por bloques."] },
                { nombre: "Evento", indicadores: ["Reconocer el evento en un entorno de programación por bloques que activa una acción o cambio visible en un objeto del programa."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Fundamentos de la IA", indicadores: ["Describir los fundamentos de la inteligencia artificial en situaciones cotidianas, utilizando ejemplos guiados y preguntas orientadoras."] },
                { nombre: "Asistentes virtuales", indicadores: ["Reconocer el uso de asistentes virtuales en situaciones cotidianas, mediante ejemplos guiados que permitan la interacción."] }
              ]
            }
          },
          "3°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Hardware", indicadores: ["Explicar las funciones básicas del hardware (entrada, procesamiento, almacenamiento y salida), en actividades prácticas con dispositivos computacionales en el aula."] },
                { nombre: "Redes de comunicación", indicadores: ["Describir qué son las redes de comunicación y cómo funciona una red local, a partir de la observación y la práctica de intercambio de información entre dispositivos conectados en el aula."] },
                { nombre: "Gestión de archivos", indicadores: ["Reconocer la gestión de archivos como proceso para la organización y clasificación de la información, mediante el uso de carpetas, subcarpetas y la exploración de archivos digitales."] },
                { nombre: "Herramienta de productividad (editor de presentaciones)", indicadores: ["Utilizar herramientas de productividad, como el editor de presentaciones, empleando la cinta de opciones, pestañas, comandos básicos y sus funciones por teclado en la elaboración de presentaciones digitales."] },
                { nombre: "Herramientas de creación de contenido multimedia (video)", indicadores: ["Aplicar herramientas de creación de contenido multimedia en la creación, edición y guardado de videos, para incorporarlos en sus producciones."] },
                { nombre: "Navegador", indicadores: ["Identificar el navegador como una herramienta digital, reconociendo sus partes y usos en actividades de exploración guiada por el docente."] },
                { nombre: "Buscador", indicadores: ["Identificar el buscador como una herramienta digital para acceder a información, distinguiendo sitios confiables y no confiables durante la exploración dirigida en buscadores infantiles."] },
                { nombre: "Netiqueta", indicadores: ["Identificar normas básicas de netiqueta que deben seguir al participar en diferentes procesos de comunicación."] },
                { nombre: "Comunicación y colaboración sincrónica y asincrónica", indicadores: ["Identificar el correo electrónico como una herramienta de comunicación asincrónica, reconociendo sus características y su uso en actividades digitales guiadas."] },
                { nombre: "Huella digital", indicadores: ["Reconocer qué es la huella digital y cómo puede afectar su privacidad y seguridad en línea, identificando que sus acciones en Internet dejan rastros que deben cuidarse."] },
                { nombre: "Software malicioso", indicadores: ["Reconocer el virus informático como un tipo de software malicioso, explicando de forma sencilla sus consecuencias, como pérdida de información o mal funcionamiento en los dispositivos."] },
                { nombre: "Riesgo en línea", indicadores: ["Reconocer algunos riesgos en línea como los perfiles falsos, la pérdida de privacidad, el contacto con extraños y la adicción al uso de dispositivos, identificando medidas básicas para protegerse en estas situaciones."] },
                { nombre: "Medidas de seguridad web", indicadores: ["Reconocer el control parental como una medida de seguridad web en el uso de Internet que protege frente a riesgos y limita el acceso a contenido inapropiado."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Algoritmo", indicadores: ["Reconocer la estructura y características de un algoritmo en diferentes representaciones, valorando el orden, inicio-fin y lógica de pasos en la solución de situaciones cotidianas."] },
                { nombre: "Variable", indicadores: ["Utilizar la gestión de una variable en un entorno de programación por bloques declarando su tipo, asignando valores y utilizando su contenido en la resolución de un ejercicio programado."] },
                { nombre: "Operadores aritméticos", indicadores: ["Utilizar operadores aritméticos de multiplicación y división y/o operadores relacionales como \"menor que\", \"mayor que\" o \"igual que\", en la resolución de un ejercicio programado."] },
                { nombre: "Operadores relacionales", indicadores: ["Utilizar operadores aritméticos de multiplicación y división y/o operadores relacionales como \"menor que\", \"mayor que\" o \"igual que\", en la resolución de un ejercicio programado."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Desafíos de la IA", indicadores: ["Identificar los desafíos de la inteligencia artificial en la vida cotidiana y algunas recomendaciones para su uso seguro y responsable, con la ayuda de ejemplos guiados."] }
              ]
            }
          },
          "4°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Hardware", indicadores: ["Clasificar componentes de hardware según su función, distinguiendo entre dispositivos computacionales y periféricos en contextos cotidianos."] },
                { nombre: "Software", indicadores: ["Reconocer el software identificando sus tipos (de sistema, de aplicación y utilitarios), valorando su función en el uso cotidiano."] },
                { nombre: "Redes de comunicación", indicadores: ["Reconocer las redes de comunicación identificando la funcionalidad y aplicación de una red local en el intercambio de información."] },
                { nombre: "Conexión entre dispositivos", indicadores: ["Reconocer la conexión entre dispositivos identificando si es física (cableada) o inalámbrica (bluetooth, Wi-Fi)."] },
                { nombre: "Gestión de archivos", indicadores: ["Organizar archivos y carpetas, aplicando acciones básicas como crear, mover, copiar, renombrar y eliminar."] },
                { nombre: "Herramienta de productividad (procesador de texto, editor de presentaciones)", indicadores: ["Utilizar herramientas de productividad en la creación de contenidos que incluyan texto, imágenes y formatos básicos."] },
                { nombre: "Herramientas de creación de contenido multimedia (Editor gráfico)", indicadores: ["Aplicar herramientas de creación de contenido multimedia utilizando funciones básicas de creación, edición y guardado de imágenes."] },
                { nombre: "Navegador", indicadores: ["Utilizar navegadores y buscadores web en la búsqueda de información en internet siguiendo una consigna dada."] },
                { nombre: "Buscador", indicadores: ["Utilizar navegadores y buscadores web en la búsqueda de información en internet siguiendo una consigna dada."] },
                { nombre: "Internet", indicadores: ["Identificar dispositivos que se conectan a internet describiendo sus funciones básicas."] },
                { nombre: "Netiqueta", indicadores: ["Aplicar normas de netiqueta durante la interacción en entornos digitales."] },
                { nombre: "Comunicación y colaboración sincrónica y asincrónica (chat)", indicadores: ["Identificar el chat como herramienta de comunicación y colaboración sincrónica y asincrónica."] },
                { nombre: "Huella digital", indicadores: ["Identificar los usos e implicaciones de la huella digital, reconociendo cómo las acciones dejan rastros permanentes."] },
                { nombre: "Contraseñas seguras", indicadores: ["Identificar qué es una contraseña segura y sus elementos básicos."] },
                { nombre: "Hackeo", indicadores: ["Identificar qué es hackeo, phishing y conexiones inseguras, reconociendo situaciones de riesgo."] },
                { nombre: "Software malicioso", indicadores: ["Identificar qué es un virus informático como tipo de software malicioso."] },
                { nombre: "Antivirus", indicadores: ["Identificar la función y características de un antivirus."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación por bloques", indicadores: ["Utilizar el entorno de programación por bloques explorando la interfaz y organizando bloques en la resolución de retos programados."] },
                { nombre: "Estado", indicadores: ["Identificar el concepto de estado, reconociendo cambios en las propiedades de orientación, dirección y tamaño."] },
                { nombre: "Algoritmo (pseudocódigo)", indicadores: ["Hacer uso de algoritmos en pseudocódigo utilizando instrucciones de forma lógica y estructurada."] },
                { nombre: "Dato", indicadores: ["Organizar datos tipo numérico y de texto, reconociendo su uso en situaciones cotidianas."] },
                { nombre: "Variable", indicadores: ["Gestionar una variable en la resolución de ejercicios a través de algoritmos o actividades programadas."] },
                { nombre: "Estructuras repetitivas", indicadores: ["Utilizar estructuras repetitivas en pseudocódigo o programación por bloques."] },
                { nombre: "Estructuras condicionales", indicadores: ["Utilizar estructuras condicionales simples y compuestas en pseudocódigo o programación."] },
                { nombre: "Operadores aritméticos", indicadores: ["Utilizar operadores aritméticos de suma, resta, multiplicación y división en pseudocódigo o programación."] },
                { nombre: "Operadores relacionales", indicadores: ["Utilizar operadores relacionales en pseudocódigo o programación, comparando valores."] },
                { nombre: "Eventos", indicadores: ["Utilizar eventos en pseudocódigo o programación para el control de acciones y reacciones."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Fundamentos de la IA", indicadores: ["Identificar los fundamentos de la inteligencia artificial, reconociendo cómo aprende, toma decisiones y se diferencia de otros sistemas automatizados."] },
                { nombre: "Asistentes virtuales", indicadores: ["Explicar el aporte de los asistentes virtuales en situaciones cotidianas, mediante el análisis de ejemplos visuales, simulaciones o actividades guiadas."] }
              ]
            }
          },
          "5°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Hardware", indicadores: ["Identificar dispositivos de hardware de entrada y salida mixtos como la impresora multifuncional y las pantallas interactivas."] },
                { nombre: "Software", indicadores: ["Identificar la funcionalidad y el propósito de los diferentes softwares de ofimática."] },
                { nombre: "Conexión entre dispositivos", indicadores: ["Identificar las formas de conexión entre dispositivos, comprendiendo los tipos de comunicación y métodos básicos para la transmisión de archivos."] },
                { nombre: "Sistema operativo", indicadores: ["Identificar la funcionalidad del escritorio en un sistema operativo, reconociendo los elementos básicos de la barra de tareas."] },
                { nombre: "Herramienta de productividad (hoja de cálculo)", indicadores: ["Identificar la funcionalidad de la hoja de cálculo como herramienta de productividad, aplicando opciones de edición y formato."] },
                { nombre: "Herramientas de creación de contenido multimedia (audio y video)", indicadores: ["Elaborar contenido (audio y/o video) aplicando herramientas de creación y edición de contenido multimedia disponibles."] },
                { nombre: "Buscador", indicadores: ["Realizar búsquedas eficientes en internet utilizando un buscador, aplicando filtros y comandos básicos, y reconociendo dominios confiables (.edu, .go, .org, .com)."] },
                { nombre: "Derechos de autor", indicadores: ["Reconocer qué es derecho de autor y cómo incorporarlo en sus producciones, evitando el plagio al citar adecuadamente las fuentes utilizadas."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación por bloques para computación física", indicadores: ["Utilizar el entorno de programación por bloques para computación física explorando la interfaz y organizando bloques."] },
                { nombre: "Lógica de programación", indicadores: ["Reconocer proposiciones como afirmaciones verdaderas o falsas en el contexto de la lógica de programación."] },
                { nombre: "Algoritmo (Diagrama de flujo)", indicadores: ["Aplicar mediante diagramas de flujo un algoritmo, utilizando símbolos y secuencias lógicas."] },
                { nombre: "Dato", indicadores: ["Utilizar datos tipo booleano en la resolución de problemas en entornos de programación."] },
                { nombre: "Variable", indicadores: ["Aplicar la gestión de variables en programación, modificando su valor durante la ejecución de algoritmos."] },
                { nombre: "Colección de datos", indicadores: ["Organizar datos en programación mediante el uso de listas o agrupaciones de elementos con características comunes."] },
                { nombre: "Estructuras condicionales", indicadores: ["Aplicar estructuras condicionales múltiples en diagramas de flujo o programación."] },
                { nombre: "Operadores Lógicos", indicadores: ["Reconocer operadores lógicos de conjunción (Y) y disyunción (O) en la resolución de problemas."] },
                { nombre: "Procedimientos/funciones", indicadores: ["Reconocer procedimientos o funciones en programación, comprendiendo cómo se declaran, invocan y se usan parámetros y argumentos."] }
              ]
            },
            "Computación física y Robótica": {
              saberes: [
                { nombre: "Robot", indicadores: ["Reconocer qué es y qué no es un robot, identificando sus componentes básicos como el cuerpo, el sistema sensorial y el sistema de control."] },
                { nombre: "Computación física", indicadores: ["Reconocer los componentes básicos de la computación física, como el microcontrolador, sensores, actuadores y el entorno de programación."] },
                { nombre: "Circuito eléctrico", indicadores: ["Identificar componentes básicos de un circuito eléctrico, reconociendo su tipo, el flujo de corriente, la polaridad y la función del interruptor."] },
                { nombre: "Fundamentos de electrónica", indicadores: ["Identificar fundamentos de electrónica, reconociendo la función de los pines de entrada y salida, así como la diferencia entre señales analógicas y digitales."] },
                { nombre: "Microcontrolador", indicadores: ["Reconocer el funcionamiento básico de un microcontrolador, identificando los pines digitales y analógicos."] },
                { nombre: "Sensor", indicadores: ["Identificar sensores integrados y externos, reconociendo su funcionamiento y la forma de conectarlos a VCC y GND."] },
                { nombre: "Actuador", indicadores: ["Identificar actuadores integrados y externos, reconociendo cómo se conectan a VCC y GND mientras generan una salida física."] },
                { nombre: "Domótica", indicadores: ["Identificar usos y aplicaciones de la domótica, reconociendo cómo la automatización mejora la comodidad y eficiencia."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Dato", indicadores: ["Identificar el dato de tipo numérico y de texto en situaciones cotidianas, a partir del registro de información."] },
                { nombre: "Recolección de datos", indicadores: ["Reconocer técnicas de recolección de datos según el tipo de información que se desea obtener."] },
                { nombre: "Almacenamiento de datos", indicadores: ["Identificar formas de almacenamiento de datos, reconociendo cómo se utilizan archivos locales y hojas de cálculo."] },
                { nombre: "Visualización de datos", indicadores: ["Identificar la visualización de datos mediante formas de representación como gráficos o tablas."] },
                { nombre: "Estrategias para presentar datos", indicadores: ["Reconocer las tablas como una estrategia para presentar datos organizadamente."] },
                { nombre: "Herramientas generativas", indicadores: ["Reconocer herramientas digitales generativas (texto, imagen o audio) que producen contenido a partir de instrucciones sencillas."] },
                { nombre: "Desafíos de la IA", indicadores: ["Reconocer desafíos de la inteligencia artificial relacionados con la protección de la información personal sensible."] }
              ]
            }
          },
          "6°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Hardware", indicadores: ["Analizar las funciones de los componentes internos del hardware como la memoria RAM, tarjeta madre, disco duro, microprocesador y tarjetas de red, video y sonido."] },
                { nombre: "Conexión entre dispositivos", indicadores: ["Explicar cómo las direcciones IP permiten la conexión entre dispositivos y su comunicación dentro de una red local o en internet."] },
                { nombre: "Redes de comunicación", indicadores: ["Describir diferentes tipos de redes de comunicación (red fija telefónica, red móvil, red de televisión por cable y red satelital)."] },
                { nombre: "Gestión de archivos", indicadores: ["Analizar la gestión de archivos considerando las propiedades de los archivos digitales (tamaño, tipo y extensión) y aplicando procesos de compresión y descompresión."] },
                { nombre: "Sistema operativo", indicadores: ["Identificar herramientas del sistema operativo como el administrador de tareas, la limpieza de archivos temporales y la gestión de memoria."] },
                { nombre: "Herramienta de productividad", indicadores: ["Utilizar la herramienta de productividad seleccionando entre opciones de ofimática local o en línea, según el contexto de uso."] },
                { nombre: "Herramientas de creación de contenido multimedia", indicadores: ["Crear contenido (imagen, audio y/o video) con herramientas de creación de contenido multimedia disponibles."] },
                { nombre: "Internet", indicadores: ["Identificar el funcionamiento básico de Internet, reconociendo cómo se establece la conectividad y el rol de los proveedores de servicios."] },
                { nombre: "Comunicación y colaboración sincrónica y asincrónica", indicadores: ["Aplicar la comunicación y colaboración sincrónica y asincrónica en la creación de documentos, organización de carpetas y gestión del correo electrónico."] },
                { nombre: "Almacenamiento en la nube", indicadores: ["Crear archivos digitales en plataformas de almacenamiento en la nube, configurando los permisos de uso compartido."] },
                { nombre: "Referencias bibliográficas", indicadores: ["Aplicar un formato básico de referencias bibliográficas (autor, título y fuente) en las producciones."] },
                { nombre: "Internet de las cosas", indicadores: ["Reconocer aplicaciones del Internet de las Cosas (IoT) en la cotidianidad."] },
                { nombre: "Moneda virtual", indicadores: ["Reconocer la utilidad e implicaciones básicas de las monedas virtuales."] },
                { nombre: "Huella digital", indicadores: ["Aplicar medidas básicas para proteger la privacidad en línea, gestionando su huella digital."] },
                { nombre: "Contraseñas seguras", indicadores: ["Reconocer la importancia de las contraseñas seguras, aplicando estrategias básicas como el uso de doble factor."] },
                { nombre: "Software malicioso", indicadores: ["Identificar las formas comunes de propagación de software malicioso y estrategias básicas de prevención."] },
                { nombre: "Riesgos en línea", indicadores: ["Identificar riesgos en línea como ciberacoso, contenido inapropiado y suplantación de identidad."] },
                { nombre: "Medidas de seguridad en la web", indicadores: ["Identificar medidas de seguridad en la web, reconociendo la diferencia entre HTTPS y HTTP."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Lógica de programación (tablas de verdad)", indicadores: ["Aplicar la lógica de programación (tablas de verdad) con operadores de conjunción y disyunción."] },
                { nombre: "Procedimientos/funciones", indicadores: ["Emplear procedimientos o funciones (declaración, invocación, parámetros y argumentos) en la resolución de ejercicios programados."] }
              ]
            },
            "Computación física y Robótica": {
              saberes: [
                { nombre: "Computación física", indicadores: ["Aplicar la computación física en la creación de soluciones automatizadas, como respuesta a necesidades concretas del entorno cotidiano."] },
                { nombre: "Prototipos", indicadores: ["Diseñar prototipos de sistemas automatizados, aplicando conocimientos de computación física para resolver necesidades concretas."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Dato", indicadores: ["Aplicar registros como datos relevantes, organizando información en tablas a partir de gastos, notas, actividades deportivas o registros básicos de salud."] },
                { nombre: "Recolección de datos", indicadores: ["Seleccionar técnicas de recolección de datos aplicándolas según el tipo de información que se desea obtener."] },
                { nombre: "Almacenamientos de datos", indicadores: ["Aplicar formas de almacenamiento de datos como archivos locales o en línea y herramientas digitales como hojas de cálculo."] },
                { nombre: "Visualización de datos", indicadores: ["Aplicar técnicas de visualización de datos, creando representaciones gráficas simples como gráficos pictóricos o de barras."] },
                { nombre: "Estrategias para presentar datos", indicadores: ["Crear gráficos de barras o lineales a partir de datos, aplicando estrategias para representar datos."] }
              ]
            }
          },
          "7°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Computadora", indicadores: ["Aplicar reglas básicas y responsabilidades durante el uso de una computadora, contribuyendo al cuidado, seguridad y prolongación de su vida útil."] },
                { nombre: "Hardware", indicadores: ["Clasificar tipos de computadoras y sus componentes principales de hardware, identificando funciones de periféricos comunes."] },
                { nombre: "Software", indicadores: ["Distinguir los tipos de software relacionándolos con sus funciones y usos en tareas cotidianas."] },
                { nombre: "Redes de comunicación", indicadores: ["Identificar tipos de redes de comunicación y sus dispositivos principales (módem, router y puntos de acceso)."] },
                { nombre: "Sistema operativo", indicadores: ["Identificar las categorías de los sistemas operativos (escritorio y dispositivos móviles), describiendo su función básica."] },
                { nombre: "Gestión de archivos", indicadores: ["Aplicar las propiedades (tamaño, tipo y extensión) en la gestión de archivos para compartir información."] },
                { nombre: "Herramienta de productividad (Procesador de texto, Editor de presentaciones)", indicadores: ["Aplicar la herramienta de productividad cómo procesador de texto y/o editor de presentación para crear productos comunicativos."] },
                { nombre: "Herramientas de creación de contenido multimedia (Editor de gráficos)", indicadores: ["Diseñar productos visuales con herramientas de creación multimedia utilizando editores gráficos."] },
                { nombre: "Internet", indicadores: ["Reconocer el funcionamiento de Internet, comprendiendo la conectividad entre dispositivos y el rol de los proveedores de servicio (ISP)."] },
                { nombre: "Navegador", indicadores: ["Utilizar el navegador y el buscador web para acceder y localizar información en línea, gestionando pestañas."] },
                { nombre: "Buscador", indicadores: ["Utilizar el navegador y el buscador web para acceder y localizar información en línea, gestionando pestañas."] },
                { nombre: "Netiqueta", indicadores: ["Utilizar herramientas de comunicación y colaboración sincrónica y asincrónica, aplicando normas de netiqueta."] },
                { nombre: "Comunicación y colaboración sincrónica/asincrónica", indicadores: ["Utilizar herramientas de comunicación y colaboración sincrónica y asincrónica, aplicando normas de netiqueta."] },
                { nombre: "Almacenamiento en la nube", indicadores: ["Utilizar el almacenamiento en la nube para guardar, organizar y compartir archivos digitales."] },
                { nombre: "Referencias bibliográficas", indicadores: ["Aplicar formatos básicos de referencias bibliográficas en producciones digitales o escritas."] },
                { nombre: "Criptomonedas", indicadores: ["Reconocer la utilidad e implicaciones del uso de criptomonedas en entornos digitales cotidianos."] },
                { nombre: "Contraseñas seguras", indicadores: ["Crear contraseñas seguras utilizando generadores aleatorios."] },
                { nombre: "Software malicioso", indicadores: ["Reconocer las características del software malicioso, analizando los riesgos asociados."] },
                { nombre: "Riesgos en línea", indicadores: ["Identificar riesgos en línea como la suplantación de identidad, grooming, phishing y noticias falsas."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación textual o bloques", indicadores: ["Reconocer un entorno de programación textual o bloques, identificando sus funciones."] },
                { nombre: "Lógica de programación", indicadores: ["Identificar la lógica de programación con el uso de proposiciones y conectores lógicos (AND, OR, NOT)."] },
                { nombre: "Algoritmo", indicadores: ["Reconocer el algoritmo identificando su estructura (entrada, proceso, salida) y aplicando sus características."] },
                { nombre: "Dato", indicadores: ["Identificar tipos de dato y formas de almacenamiento, aplicándolos en la creación de algoritmos."] },
                { nombre: "Variable", indicadores: ["Identificar tipos de variable, aplicando su gestión mediante declaraciones y asignaciones."] },
                { nombre: "Estructuras condicionales", indicadores: ["Aplicar estructuras condicionales en un entorno de programación para la resolución de desafíos."] },
                { nombre: "Estructuras repetitivas", indicadores: ["Aplicar estructuras repetitivas en un entorno de programación para resolver desafíos."] },
                { nombre: "Operadores aritméticos", indicadores: ["Aplicar operadores aritméticos (suma, resta, multiplicación y división) para resolver cálculos."] },
                { nombre: "Operadores relacionales", indicadores: ["Aplicar operadores relacionales para realizar comparaciones."] },
                { nombre: "Operadores lógicos", indicadores: ["Aplicar operadores lógicos (Y, O, NO) en la resolución de desafíos de programación."] },
                { nombre: "Evento", indicadores: ["Aplicar un evento como acción que se detona mediante una causa y un efecto."] },
                { nombre: "Procedimientos y/o funciones", indicadores: ["Aplicar procedimientos y/o funciones como estructura modular, a través de su declaración e invocación."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Dato", indicadores: ["Identificar tipos de dato (numéricos, de texto, de ubicación y de imágenes), analizando cómo influye en decisiones."] },
                { nombre: "Fundamentos de la IA", indicadores: ["Reconocer los fundamentos de la inteligencia artificial, identificando el concepto y sus aplicaciones."] },
                { nombre: "Asistentes virtuales", indicadores: ["Identificar qué son los asistentes virtuales basados en inteligencia artificial, reconociendo su utilidad."] }
              ]
            }
          },
          "8°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Hardware", indicadores: ["Analizar el funcionamiento de los componentes internos del hardware, describiendo cómo influyen en el rendimiento."] },
                { nombre: "Software", indicadores: ["Analizar los tipos de software según su función, comparando las características y usos."] },
                { nombre: "Redes de comunicación", indicadores: ["Identificar las funciones de las unidades de almacenamiento de las redes de comunicación."] },
                { nombre: "Conexión entre dispositivos", indicadores: ["Distinguir las formas de conexión entre dispositivos mediante comunicación física o inalámbrica."] },
                { nombre: "Sistema Operativo", indicadores: ["Reconocer las características del sistema operativo y la diferencia entre software libre y de paga."] },
                { nombre: "Gestión de archivos", indicadores: ["Aplicar la compresión y descompresión de archivos como parte de la gestión de archivos digitales."] },
                { nombre: "Herramienta de productividad (Hoja de cálculo)", indicadores: ["Utilizar la hoja de cálculo como herramienta de productividad en la organización y representación de datos."] },
                { nombre: "Herramientas de creación de contenido multimedia (Edición de audio y video)", indicadores: ["Utilizar herramientas de creación de contenido multimedia en la edición de audio o video."] },
                { nombre: "Buscador", indicadores: ["Utilizar el buscador web como herramienta para la localización de información, aplicando criterios que identifiquen fuentes confiables."] },
                { nombre: "Plataformas de creación de contenido", indicadores: ["Utilizar plataformas de creación de contenido digital en la elaboración de infografías, diagramas o presentaciones."] },
                { nombre: "Licencia", indicadores: ["Reconocer la licencia digital en el uso de contenido en línea, valorando sus alcances y limitaciones."] },
                { nombre: "Internet de las cosas", indicadores: ["Analizar aplicaciones del Internet de las cosas en la automatización de tareas."] },
                { nombre: "Hackeo", indicadores: ["Reconocer el hackeo como una amenaza digital, diferenciando tipos de hacker."] },
                { nombre: "Software malicioso", indicadores: ["Aplicar medidas de protección digital mediante el reconocimiento de tipos de software malicioso y el uso adecuado del antivirus."] },
                { nombre: "Antivirus", indicadores: ["Aplicar medidas de protección digital mediante el reconocimiento de tipos de software malicioso y el uso adecuado del antivirus."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación textual o bloques para programar mecanismos robóticos", indicadores: ["Aplicar el entorno de programación textual o por bloques para programar mecanismos robóticos, utilizando estructuras y eventos."] },
                { nombre: "Colección de datos", indicadores: ["Gestionar una colección de datos como listas o arreglos mediante su creación, recorrido y modificación."] }
              ]
            },
            "Computación física y Robótica": {
              saberes: [
                { nombre: "Robot", indicadores: ["Reconocer qué es un robot, sus tipos y componentes (cuerpo, sistema sensorial y sistema de control)."] },
                { nombre: "Robótica", indicadores: ["Diferenciar la computación física con la robótica, identificando cómo los sensores, actuadores y sistemas de control se integran."] },
                { nombre: "Mecánica aplicada a la robótica", indicadores: ["Emplear principios de la mecánica aplicados a la robótica, como la estructura y la estabilidad."] },
                { nombre: "Mecanismos", indicadores: ["Reconocer los tipos de mecanismos, identificando su función principal en la transmisión y transformación del movimiento."] },
                { nombre: "Circuito eléctrico", indicadores: ["Identificar los componentes de un circuito eléctrico y su funcionamiento."] },
                { nombre: "Fundamentos de electrónica", indicadores: ["Identificar fundamentos de electrónica, reconociendo la función de pines de entrada y salida."] },
                { nombre: "Microcontrolador", indicadores: ["Comprender los componentes básicos de un microcontrolador, aplicando la función de pines digitales y analógicos."] },
                { nombre: "Sensor", indicadores: ["Utilizar un sensor integrado y/o externo, comprendiendo su función y su correcta conexión a VCC y GND."] },
                { nombre: "Actuador", indicadores: ["Utilizar un actuador integrado y/o externo, comprendiendo su función y cómo se conecta correctamente a VCC y GND."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Recolección de datos", indicadores: ["Aplicar técnicas de recolección de datos mediante registros escolares y personales."] },
                { nombre: "Fundamentos de la IA", indicadores: ["Reconocer los fundamentos de la inteligencia artificial, identificando cómo funciona y se diferencia de otros sistemas digitales."] },
                { nombre: "Herramientas generativas", indicadores: ["Utilizar herramientas generativas basadas en inteligencia artificial, aplicando funciones para la creación o modificación de contenido digital."] }
              ]
            }
          },
          "9°": {
            "Apropiación tecnológica y Digital": {
              saberes: [
                { nombre: "Redes de comunicación", indicadores: ["Reconocer las redes de comunicación a partir de su arquitectura, protocolos (como HTTP, HTTPS и TCP/IP) e interfaces."] },
                { nombre: "Sistema Operativo", indicadores: ["Aplicar técnicas de optimización del sistema operativo, identificando cómo gestionar memoria, desfragmentar discos, limpiar caché y actualizar el sistema."] },
                { nombre: "Herramienta de productividad (Gestor de bases de datos)", indicadores: ["Utilizar un gestor de bases de datos como herramienta de productividad para la creación de tablas, estableciendo relaciones entre ellas y realizando consultas."] },
                { nombre: "Herramientas de creación de contenido multimedia", indicadores: ["Utilizar herramientas de creación de contenido multimedia para el modelado 3D."] },
                { nombre: "Plataformas de creación de contenido", indicadores: ["Crear encuestas o formularios mediante plataformas de creación de contenido, ajustando su formato y estructura."] },
                { nombre: "Derechos de autor y licenciamiento", indicadores: ["Reconocer la importancia de los derechos de autor y el licenciamiento, aplicando buenas prácticas de uso ético y legal."] },
                { nombre: "Huella digital", indicadores: ["Analizar la utilidad e implicaciones de la huella digital, valorando cómo las acciones en línea afectan la identidad, reputación y seguridad."] },
                { nombre: "Riesgos en línea", indicadores: ["Analizar riesgos en línea (acceso a información inapropiada, ciberadicción, ciberacoso y el sexting)."] }
              ]
            },
            "Programación y Algoritmos": {
              saberes: [
                { nombre: "Entorno de programación textual o bloques para programar mecanismos robóticos", indicadores: ["Diseñar soluciones automatizadas en un entorno de programación textual o por bloques para programar mecanismos robóticos."] },
                { nombre: "Algoritmo", indicadores: ["Diseñar un algoritmo para resolver un problema, representándolo de forma estructurada mediante pseudocódigo o diagrama de flujo."] }
              ]
            },
            "Computación física y Robótica": {
              saberes: [
                { nombre: "Movimiento en mecanismos", indicadores: ["Identificar el movimiento en mecanismos robóticos, diferenciando el movimiento de entrada y salida."] },
                { nombre: "Microcontrolador", indicadores: ["Aplicar las funciones de un microcontrolador, utilizando pines digitales y analógicos, conexión a VCC y GND."] },
                { nombre: "Sensor", indicadores: ["Integrar un sensor en un prototipo, utilizando sus datos como entrada para generar respuestas automatizadas."] },
                { nombre: "Actuador", indicadores: ["Integrar un actuador en un prototipo, programando su activación como respuesta a entradas digitales o condiciones del sistema."] },
                { nombre: "Domótica", indicadores: ["Analizar los usos, aplicaciones y beneficios de la domótica, mediante la creación o simulación de un prototipo."] },
                { nombre: "Prototipos", indicadores: ["Construir prototipos que integren sensores, actuadores y un microcontrolador, a partir de una necesidad identificada."] }
              ]
            },
            "Ciencia de datos e Inteligencia artificial": {
              saberes: [
                { nombre: "Dato", indicadores: ["Reconocer la importancia de la organización y conservación del dato, aplicando criterios de seguridad y responsabilidad."] },
                { nombre: "Almacenamiento de datos", indicadores: ["Reconocer el ciclo de vida del dato en el almacenamiento de datos, identificando las etapas de creación, uso, conservación y eliminación responsable."] },
                { nombre: "Herramientas generativas", indicadores: ["Aplicar herramientas generativas con inteligencia artificial en la producción de contenido digital, considerando criterios de seguridad, propiedad intelectual y responsabilidad digital."] },
                { nombre: "Desafíos de la IA", indicadores: ["Reconocer los desafíos de la inteligencia artificial, identificando riesgos como sesgos, manipulación de información, dependencia tecnológica y privacidad de datos."] }
              ]
            }
          }
        };

        // ===== RESULTADOS DE APRENDIZAJE (RdA) POR CICLO Y ÁREA =====
        const RDA_POR_CICLO = {
          "Preescolar": {
            "Apropiación tecnológica y Digital": "Identifica los dispositivos digitales considerando características funcionales, experimentando su utilidad y reconociendo la autoría, durante la accesibilidad, interacción y comunicación en la creación de recursos digitales.",
            "Programación y Algoritmos": "Ordena secuencias integrando conceptos de programación como dato, evento, estado, ciclos, así como nociones de lateralidad y orientación espacial, en la solución de desafíos propuestos, utilizando la programación iconográfica por bloques.",
            "Computación física y Robótica": "Reconoce el funcionamiento de los robots, así como sus componentes (cuerpo, sistema sensorial, sistemas de control), al clasificarlos por su uso y programarlos para resolver retos.",
            "Ciencia de datos e Inteligencia artificial": "Reconoce los conceptos básicos relacionados con la recopilación, organización e interpretación de datos, mediante gráficos pictóricos en la resolución de problemas, fomentando el pensamiento crítico y la curiosidad hacia el mundo que lo rodea."
          },
          "I Ciclo": {
            "Apropiación tecnológica y Digital": "Selecciona los dispositivos digitales y herramientas de productividad, mediante el uso de software y hardware, en la creación de archivos, creación y edición de contenido multimedia, aprovechando Internet y respetando la propiedad intelectual en la realización de tareas para la accesibilidad a la información de forma segura y responsable.",
            "Programación y Algoritmos": "Selecciona conceptos de programación como dato, secuencia, evento, estado, variables, operadores aritméticos y relacionales, condicionales simples, ciclo finito e infinito, en la programación por bloques para la solución de problemas.",
            "Computación física y Robótica": "No aplica para este ciclo.",
            "Ciencia de datos e Inteligencia artificial": "Reconoce los fundamentos de la inteligencia artificial y su presencia en la vida cotidiana, mediante ejemplos concretos como asistentes virtuales, valorando el uso seguro y responsable de estas tecnologías."
          },
          "II Ciclo": {
            "Apropiación tecnológica y Digital": "Selecciona la configuración de programas locales y en línea para su correcto uso al crear, buscar, compartir, organizar y administrar información en la realización de diferentes tareas de manera comprensiva, segura y responsable.",
            "Programación y Algoritmos": "Crea algoritmos que integran los conceptos de programación como secuencia, evento, estructuras de control (condicionales simples y ciclos), en la solución a problemas del contexto mediante la programación por bloques.",
            "Computación física y Robótica": "Crea algoritmos que permiten la simulación de comportamientos de aparatos tecnológicos, aplicando elementos de computación física, programación y electrónica para la resolución de un problema.",
            "Ciencia de datos e Inteligencia artificial": "Reconoce el uso de la inteligencia artificial en contextos cotidianos y aplica técnicas básicas de recolección, análisis y representación de datos mediante tablas y gráficos."
          },
          "III Ciclo": {
            "Apropiación tecnológica y Digital": "Combina herramientas digitales, tomando en cuenta fundamentos de tecnología, impacto de las TIC, seguridad y privacidad digital y su experiencia de uso, en la realización de productos digitales.",
            "Programación y Algoritmos": "Integra conceptos de programación como eventos, operadores, estructuras de datos, estructuras de control, procedimientos, funciones, colecciones de datos y algoritmos (diagrama de flujo y pseudocódigo), en la solución de problemas reales.",
            "Computación física y Robótica": "Aplica fundamentos de robótica, computación física, electrónica, mecánica y sistemas robóticos autónomos en la programación y construcción de prototipos que resuelven un problema.",
            "Ciencia de datos e Inteligencia artificial": "Analiza datos mediante herramientas digitales que permiten su visualización para la toma de decisiones en situaciones cotidianas y reconoce aspectos fundamentales de la inteligencia artificial, incluyendo sus aplicaciones actuales y desafíos asociados."
          }
        };

        // ===== VARIABLES GLOBALES =====
        let semanaCounter = 0;
        let planesGuardados = JSON.parse(localStorage.getItem('planesDidacticos')) || [];
        let planSeleccionado = null;
        let saberesSeleccionadosGlobal = new Set(); // MEJORA: Conjunto global de saberes seleccionados

        // ===== INICIALIZACIÓN =====
        document.addEventListener('DOMContentLoaded', function() {
            inicializarEventListeners();
            limpiarFormulario();
            console.log("✅ Sistema PNFT inicializado - Base de datos completa cargada");
        });

        function inicializarEventListeners() {
            // Metodología activa
            document.getElementById('metodologiaActiva').addEventListener('change', function() {
                document.getElementById('metodologiaOtra').style.display = this.value === 'otra' ? 'block' : 'none';
            });

            // Areas de conocimiento
            document.querySelectorAll('input[name="area"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    actualizarRda();
                    actualizarSaberesEnTodasLasSemanas();
                    guardarDatosAutomaticamente();
                });
            });

            // Ciclo y nivel
            document.getElementById('ciclo').addEventListener('change', function() {
                actualizarRda();
                guardarDatosAutomaticamente();
            });
            
            document.getElementById('nivel').addEventListener('change', function() {
                actualizarRda();
                actualizarSaberesEnTodasLasSemanas();
                guardarDatosAutomaticamente();
            });

            // Lecciones planificadas
            document.getElementById('leccionesPlanificadas').addEventListener('change', function() {
                document.getElementById('totalLecciones').textContent = this.value;
                generarSemanas();
                guardarDatosAutomaticamente();
            });

            // Saberes manuales
            document.getElementById('saberesManuales').addEventListener('input', function() {
                actualizarSaberesManualesEnTodasLasSemanas();
                guardarDatosAutomaticamente();
            });

            // Ejes transversales - selección múltiple
            document.querySelectorAll('.eje-option').forEach(option => {
                option.addEventListener('click', function(e) {
                    if (e.target.type !== 'checkbox') {
                        const checkbox = this.querySelector('input[type="checkbox"]');
                        checkbox.checked = !checkbox.checked;
                    }
                    this.classList.toggle('selected', this.querySelector('input[type="checkbox"]').checked);
                    guardarDatosAutomaticamente();
                });
            });

            // Guardar automáticamente cuando se escriba en cualquier campo
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('input-field') || 
                    e.target.classList.contains('textarea-field') ||
                    e.target.classList.contains('contenedor-editable') ||
                    e.target.classList.contains('select-field')) {
                    guardarDatosAutomaticamente();
                }
            });

            // Guardar automáticamente cuando se cambien checkboxes
            document.addEventListener('change', function(e) {
                if (e.target.type === 'checkbox' || e.target.type === 'radio') {
                    guardarDatosAutomaticamente();
                }
            });
        }

        // ===== LIMPIAR FORMULARIO AL INICIO =====
        function limpiarFormulario() {
            // Limpiar campos principales
            document.getElementById('direccionRegional').value = '';
            document.getElementById('centroEducativo').value = '';
            document.getElementById('codigoCentro').value = '';
            document.getElementById('nombreDocente').value = '';
            document.getElementById('ciclo').value = '';
            document.getElementById('nivel').value = '';
            document.getElementById('mesInicio').value = '';
            document.getElementById('mesFinal').value = '';
            
            // Limpiar checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('.eje-option').forEach(option => option.classList.remove('selected'));
            
            // Limpiar textareas
            document.getElementById('metodologiaOtra').value = '';
            document.getElementById('saberesManuales').value = '';
            document.getElementById('queFunciono').value = '';
            document.getElementById('queNoFunciono').value = '';
            document.getElementById('queMejorar').value = '';
            document.getElementById('observaciones').value = '';
            
            // Limpiar contenedores
            document.getElementById('rdaContainer').innerHTML = '<div class="saberes-info">Seleccione un nivel y al menos un área de conocimiento</div>';
            document.getElementById('semanasContainer').innerHTML = '<div class="saberes-info">Ingrese la cantidad de lecciones planificadas para generar las semanas</div>';
            
            // Limpiar contadores
            document.getElementById('totalLecciones').textContent = '8';
            document.getElementById('totalSemanas').textContent = '0';
            
            // Limpiar saberes seleccionados
            saberesSeleccionadosGlobal.clear();
            actualizarSaberesSeleccionadosDisplay();
            
            // Limpiar localStorage
            localStorage.removeItem('planActual');
        }

        // ===== SISTEMA DE GUARDADO AUTOMÁTICO =====
        function guardarDatosAutomaticamente() {
            const datos = recopilarDatosPlan();
            localStorage.setItem('planActual', JSON.stringify(datos));
        }

        // ===== SISTEMA DE SEMANAS MEJORADO =====
        function generarSemanas() {
            const lecciones = parseInt(document.getElementById('leccionesPlanificadas').value) || 0;
            const semanasContainer = document.getElementById('semanasContainer');
            
            if (lecciones < 1) {
                semanasContainer.innerHTML = '<div class="saberes-info">Ingrese la cantidad de lecciones planificadas</div>';
                document.getElementById('totalSemanas').textContent = '0';
                return;
            }

            const cantidadSemanas = Math.ceil(lecciones / 4);
            document.getElementById('totalSemanas').textContent = cantidadSemanas;
            
            let html = '';
            semanaCounter = 0;
            
            for (let i = 0; i < cantidadSemanas; i++) {
                const leccionInicio = (i * 4) + 1;
                const leccionFin = Math.min((i + 1) * 4, lecciones);
                const leccionesEnSemana = leccionFin - leccionInicio + 1;
                
                html += crearHTMLSemana(i, leccionInicio, leccionFin, leccionesEnSemana);
                semanaCounter++;
            }
            
            semanasContainer.innerHTML = html;
            actualizarSaberesEnTodasLasSemanas();
            actualizarSaberesManualesEnTodasLasSemanas();
            
            // Cargar datos guardados para las semanas
            cargarDatosSemanasGuardados();
        }

        function crearHTMLSemana(index, leccionInicio, leccionFin, leccionesEnSemana) {
            return `
            <div class="semana-item" data-semana-index="${index}">
                <!-- MEJORA 1: SABERES SEMANA ARRIBA DE TODO -->
                <div class="saberes-semana-container">
                    <div class="section-title">Saberes Conceptuales para esta semana</div>
                    <div class="saberes-semana-opciones" id="saberesSemana${index}">
                        <div class="saberes-info">Seleccione nivel y áreas de conocimiento</div>
                    </div>
                    <div class="saberes-manuales-container">
                        <strong>Saberes manuales para esta semana:</strong>
                        <div id="saberesManualesSemana${index}" class="saberes-manuales-lista">
                            <em>No hay saberes manuales definidos</em>
                        </div>
                    </div>
                </div>
                
                <div class="semana-header">
                    <strong>Semana: <input type="text" class="semana-nombre" value="Semana ${leccionInicio}-${leccionFin}"></strong>
                    <!-- MEJORA 2: ELIMINADO LECCIONES INFO -->
                    ${index > 0 ? '<button type="button" class="btn-eliminar-semana" onclick="eliminarSemana(this)">✕</button>' : ''}
                </div>
                
                <div class="semana-content">
                    <div class="semana-col">
                        <div class="semana-col-title">
                            Indicadores de logro
                            <button class="expand-btn" onclick="toggleExpansion(this)" title="Expandir">+</button>
                        </div>
                        <div class="contenedor-editable" contenteditable="false" style="background: #f8f9fa;">
                            Seleccione saberes conceptuales...
                        </div>
                    </div>
                    <div class="semana-col">
                        <div class="semana-col-title">
                            Estrategias de Mediación
                            <button class="expand-btn" onclick="toggleExpansion(this)" title="Expandir">+</button>
                        </div>
                        <div class="contenedor-editable" contenteditable="true" id="estrategiasSemana${index}" data-placeholder="Escriba sus estrategias de mediación aquí..."></div>
                        <button type="button" class="copilot-btn" onclick="abrirSelectorIA(${index})">📋 Copiar Prompt para IA Externa</button>
                    </div>
                    <div class="semana-col">
                        <div class="semana-col-title">
                            Indicador de evaluación
                            <button class="expand-btn" onclick="toggleExpansion(this)" title="Expandir">+</button>
                        </div>
                        <div class="contenedor-editable" contenteditable="true" data-placeholder="Indicador de evaluación..."></div>
                    </div>
                </div>
            </div>`;
        }

        function agregarSemanaManual() {
            const semanasContainer = document.getElementById('semanasContainer');
            const leccionesActuales = parseInt(document.getElementById('leccionesPlanificadas').value) || 0;
            const nuevaLeccionInicio = leccionesActuales + 1;
            const nuevaLeccionFin = leccionesActuales + 4;
            
            document.getElementById('leccionesPlanificadas').value = leccionesActuales + 4;
            document.getElementById('totalLecciones').textContent = leccionesActuales + 4;
            
            const nuevaSemanaHTML = crearHTMLSemana(semanaCounter, nuevaLeccionInicio, nuevaLeccionFin, 4);
            semanasContainer.insertAdjacentHTML('beforeend', nuevaSemanaHTML);
            
            semanaCounter++;
            document.getElementById('totalSemanas').textContent = document.querySelectorAll('.semana-item').length;
            
            actualizarSaberesEnTodasLasSemanas();
            actualizarSaberesManualesEnTodasLasSemanas();
            guardarDatosAutomaticamente();
            
            alert('✅ Semana agregada correctamente');
        }

        function eliminarSemana(boton) {
            const semana = boton.closest('.semana-item');
            const index = parseInt(semana.getAttribute('data-semana-index'));
            
            if (index === 0) {
                alert("No se puede eliminar la primera semana.");
                return;
            }
            
            if (confirm("¿Está seguro de que desea eliminar esta semana? Los datos de las otras semanas se conservarán.")) {
                const leccionesEnSemana = parseInt(semana.querySelector('.lecciones-contador').textContent);
                const leccionesActuales = parseInt(document.getElementById('leccionesPlanificadas').value);
                document.getElementById('leccionesPlanificadas').value = leccionesActuales - leccionesEnSemana;
                document.getElementById('totalLecciones').textContent = leccionesActuales - leccionesEnSemana;
                
                semana.remove();
                reindexarSemanas();
                document.getElementById('totalSemanas').textContent = document.querySelectorAll('.semana-item').length;
                guardarDatosAutomaticamente();
            }
        }

        // ===== FUNCIONALIDADES PRINCIPALES =====
        function actualizarRda() {
            const nivel = document.getElementById('nivel').value;
            const ciclo = document.getElementById('ciclo').value;
            const areasSeleccionadas = Array.from(document.querySelectorAll('input[name="area"]:checked')).map(cb => cb.value);
            const container = document.getElementById('rdaContainer');

            if (!nivel || areasSeleccionadas.length === 0) {
                container.innerHTML = '<div class="saberes-info">Seleccione un nivel y al menos un área de conocimiento</div>';
                return;
            }

            let html = '';
            areasSeleccionadas.forEach(areaKey => {
                const areaNombre = getAreaName(areaKey);
                const rda = RDA_POR_CICLO[ciclo]?.[areaNombre] || "RdA no definido para esta área y ciclo";
                html += `<div class="rda-item"><strong>${areaNombre}:</strong><br>${rda}</div><div class="rda-divider"></div>`;
            });

            container.innerHTML = html;
        }

        function actualizarSaberesEnTodasLasSemanas() {
            const nivel = document.getElementById('nivel').value;
            const areasSeleccionadas = Array.from(document.querySelectorAll('input[name="area"]:checked')).map(cb => cb.value);
            const semanas = document.querySelectorAll('.semana-item');
            
            semanas.forEach((semana, index) => {
                const container = semana.querySelector('.saberes-semana-opciones');
                cargarSaberesEnContenedor(container, nivel, areasSeleccionadas, index);
            });
        }

        function cargarSaberesEnContenedor(container, nivel, areasSeleccionadas, semanaIndex) {
            if (!nivel || areasSeleccionadas.length === 0) {
                container.innerHTML = '<div class="saberes-info">Seleccione nivel y áreas de conocimiento</div>';
                return;
            }

            const nivelData = PNFT_DATA[nivel];
            if (!nivelData) {
                container.innerHTML = '<div class="saberes-info">No hay datos para este nivel</div>';
                return;
            }

            let html = '';
            areasSeleccionadas.forEach(areaKey => {
                const areaNombre = getAreaName(areaKey);
                const areaData = nivelData[areaNombre];
                
                if (areaData && areaData.saberes.length > 0) {
                    html += `<div class="area-saberes"><strong>${areaNombre}:</strong><br>`;
                    areaData.saberes.forEach(saber => {
                        const estaSeleccionado = saberesSeleccionadosGlobal.has(saber.nombre);
                        html += `<label class="saber-item">
                                    <input type="checkbox" name="saberConceptualSemana${semanaIndex}" 
                                           value="${saber.nombre}" 
                                           data-indicadores='${JSON.stringify(saber.indicadores)}'
                                           data-semana-index="${semanaIndex}"
                                           ${estaSeleccionado ? 'checked' : ''}
                                           onchange="manejarSeleccionSaber(this); guardarDatosAutomaticamente()">
                                    <span>${saber.nombre}</span>
                                </label><br>`;
                    });
                    html += '</div><br>';
                }
            });

            container.innerHTML = html || '<div class="saberes-info">No hay saberes para esta combinación</div>';
        }

        // ===== MEJORA PRINCIPAL: SISTEMA DE SABERES SELECCIONADOS GLOBAL =====
        function manejarSeleccionSaber(checkbox) {
            const saberNombre = checkbox.value;
            const semanaIndex = checkbox.getAttribute('data-semana-index');
            
            if (checkbox.checked) {
                saberesSeleccionadosGlobal.add(saberNombre);
            } else {
                saberesSeleccionadosGlobal.delete(saberNombre);
            }
            
            // Actualizar el display de saberes seleccionados
            actualizarSaberesSeleccionadosDisplay();
            
            // Actualizar indicadores de logro para esta semana
            actualizarIndicadoresLogroSemana(checkbox);
        }

        function actualizarSaberesSeleccionadosDisplay() {
            const container = document.getElementById('saberesSeleccionadosLista');
            const contador = document.getElementById('totalSaberes');
            
            if (saberesSeleccionadosGlobal.size === 0) {
                container.innerHTML = '<div class="saberes-info">Seleccione saberes conceptuales en las semanas para verlos aquí</div>';
                contador.textContent = '0';
                return;
            }
            
            let html = '';
            saberesSeleccionadosGlobal.forEach(saber => {
                html += `
                <div class="saber-seleccionado-item">
                    ${saber}
                    <button class="eliminar" onclick="eliminarSaberGlobal('${saber}')" title="Eliminar saber">✕</button>
                </div>`;
            });
            
            container.innerHTML = html;
            contador.textContent = saberesSeleccionadosGlobal.size;
        }

        function eliminarSaberGlobal(saberNombre) {
            // Eliminar del conjunto global
            saberesSeleccionadosGlobal.delete(saberNombre);
            
            // Desmarcar todos los checkboxes correspondientes en todas las semanas
            document.querySelectorAll(`input[type="checkbox"][value="${saberNombre}"]`).forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Actualizar el display
            actualizarSaberesSeleccionadosDisplay();
            
            // Actualizar indicadores de logro en todas las semanas afectadas
            actualizarIndicadoresLogroEnTodasLasSemanas();
            
            guardarDatosAutomaticamente();
        }

        function actualizarSaberesManualesEnTodasLasSemanas() {
            const saberesManuales = document.getElementById('saberesManuales').value;
            const saberesArray = saberesManuales.split(';').filter(saber => saber.trim() !== '');
            const semanas = document.querySelectorAll('.semana-item');
            
            semanas.forEach((semana, index) => {
                const container = semana.querySelector(`#saberesManualesSemana${index}`);
                if (saberesArray.length > 0) {
                    let html = '<div style="margin-top: 10px;">';
                    saberesArray.forEach((saber, i) => {
                        const saberTrim = saber.trim();
                        const estaSeleccionado = saberesSeleccionadosGlobal.has(saberTrim);
                        html += `<label class="saber-item">
                                    <input type="checkbox" name="saberManualSemana${index}" 
                                           value="${saberTrim}" 
                                           data-semana-index="${index}"
                                           ${estaSeleccionado ? 'checked' : ''}
                                           onchange="manejarSeleccionSaberManual(this); guardarDatosAutomaticamente()">
                                    <span>${saberTrim}</span>
                                </label>${i < saberesArray.length - 1 ? '<br>' : ''}`;
                    });
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<em>No hay saberes manuales definidos</em>';
                }
            });
        }

        function manejarSeleccionSaberManual(checkbox) {
            const saberNombre = checkbox.value;
            const semanaIndex = checkbox.getAttribute('data-semana-index');
            
            if (checkbox.checked) {
                saberesSeleccionadosGlobal.add(saberNombre);
            } else {
                saberesSeleccionadosGlobal.delete(saberNombre);
            }
            
            // Actualizar el display de saberes seleccionados
            actualizarSaberesSeleccionadosDisplay();
            
            // Actualizar indicadores de logro para esta semana
            actualizarIndicadoresLogroSemana(checkbox);
        }

        // ===== MEJORA 1: INDICADORES DE LOGRO CON FORMATO DE LISTA MEJORADO =====
        function actualizarIndicadoresLogroSemana(checkbox) {
            const semanaIndex = checkbox.getAttribute('data-semana-index');
            const semana = document.querySelector(`.semana-item[data-semana-index="${semanaIndex}"]`);
            const contenedor = semana.querySelector('.contenedor-editable[contenteditable="false"]');
            
            const saberesSeleccionados = Array.from(semana.querySelectorAll(`input[name="saberConceptualSemana${semanaIndex}"]:checked`));
            const saberesManualesSeleccionados = Array.from(semana.querySelectorAll(`input[name="saberManualSemana${semanaIndex}"]:checked`));
            
            let indicadores = [];
            
            saberesSeleccionados.forEach(cb => {
                try {
                    const indicadoresSaber = JSON.parse(cb.getAttribute('data-indicadores') || '[]');
                    indicadores = indicadores.concat(indicadoresSaber);
                } catch (error) {
                    console.error("Error parseando indicadores:", error);
                }
            });
            
            saberesManualesSeleccionados.forEach(cb => {
                indicadores.push(`Aplica el concepto de "${cb.value}" en situaciones prácticas del contexto educativo.`);
            });
            
            // MEJORA: Usar formato de lista HTML con mejor espaciado
            if (indicadores.length > 0) {
                contenedor.innerHTML = `<ul class="indicadores-lista">${indicadores.map(ind => `<li>${ind}</li>`).join('')}</ul>`;
            } else {
                contenedor.innerHTML = "Seleccione al menos dos saberes conceptuales para esta semana.";
            }
        }

        function actualizarIndicadoresLogroEnTodasLasSemanas() {
            const semanas = document.querySelectorAll('.semana-item');
            semanas.forEach((semana, index) => {
                const contenedor = semana.querySelector('.contenedor-editable[contenteditable="false"]');
                const saberesSeleccionados = Array.from(semana.querySelectorAll(`input[name="saberConceptualSemana${index}"]:checked`));
                const saberesManualesSeleccionados = Array.from(semana.querySelectorAll(`input[name="saberManualSemana${index}"]:checked`));
                
                let indicadores = [];
                
                saberesSeleccionados.forEach(cb => {
                    try {
                        const indicadoresSaber = JSON.parse(cb.getAttribute('data-indicadores') || '[]');
                        indicadores = indicadores.concat(indicadoresSaber);
                    } catch (error) {
                        console.error("Error parseando indicadores:", error);
                    }
                });
                
                saberesManualesSeleccionados.forEach(cb => {
                    indicadores.push(`Aplica el concepto de "${cb.value}" en situaciones prácticas del contexto educativo.`);
                });
                
                if (indicadores.length > 0) {
                    contenedor.innerHTML = `<ul class="indicadores-lista">${indicadores.map(ind => `<li>${ind}</li>`).join('')}</ul>`;
                } else {
                    contenedor.innerHTML = "Seleccione al menos dos saberes conceptuales para esta semana.";
                }
            });
        }

        // ===== MEJORA 2: SISTEMA DE IA EXTERNA MEJORADO =====
        function abrirSelectorIA(semanaIndex) {
            const prompt = generarPromptExternoCompleto(semanaIndex);
            
            const modalHTML = `
            <div id="selectorIAModal" class="modal" style="display: block;">
                <div class="modal-content" style="text-align: center; max-width: 500px;">
                    <h3>🪄 Enviar Prompt a IA Externa</h3>
                    <p style="margin: 15px 0; color: #666;">El prompt se copiará automáticamente al portapapeles</p>
                    
                    <div style="display: flex; gap: 15px; justify-content: center; margin: 20px 0;">
                        <button class="btn btn-primary" onclick="seleccionarIA('chatgpt', ${semanaIndex})" 
                                style="padding: 15px 25px; font-size: 16px;">
                            🤖 ChatGPT
                        </button>
                        <button class="btn btn-primary" onclick="seleccionarIA('copilot', ${semanaIndex})" 
                                style="padding: 15px 25px; font-size: 16px; background: #0078d4;">
                            🚀 Microsoft Copilot
                        </button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: left;">
                        <strong>Instrucciones:</strong>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li>Seleccione la IA de su preferencia</li>
                            <li>El prompt se copiará automáticamente</li>
                            <li>Se abrirá la página de la IA en nueva pestaña</li>
                            <li>Pegue el prompt con Ctrl+V</li>
                            <li>¡Listo para usar!</li>
                        </ol>
                    </div>
                    
                    <button onclick="cerrarModalIA()" class="btn btn-outline" style="width: 100%; margin-top: 15px;">
                        Cancelar
                    </button>
                </div>
            </div>`;
            
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }

        function seleccionarIA(tipo, semanaIndex) {
            const prompt = generarPromptExternoCompleto(semanaIndex);
            
            // Copiar al portapapeles
            navigator.clipboard.writeText(prompt).then(() => {
                // Abrir la IA correspondiente
                const urls = {
                    'chatgpt': 'https://chat.openai.com/',
                    'copilot': 'https://copilot.microsoft.com/'
                };
                
                window.open(urls[tipo], '_blank');
                
                // Mostrar confirmación
                const nombreIA = tipo === 'chatgpt' ? 'ChatGPT' : 'Microsoft Copilot';
                alert(`✅ Prompt copiado al portapapeles\n\nAhora:\n1. Vaya a la pestaña de ${nombreIA}\n2. Pegue con Ctrl+V\n3. ¡Listo para usar!`);
                
                cerrarModalIA();
            }).catch(err => {
                // Fallback para navegadores que no soportan clipboard API
                const textarea = document.createElement('textarea');
                textarea.value = prompt;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                
                const urls = {
                    'chatgpt': 'https://chat.openai.com/',
                    'copilot': 'https://copilot.microsoft.com/'
                };
                
                window.open(urls[tipo], '_blank');
                
                const nombreIA = tipo === 'chatgpt' ? 'ChatGPT' : 'Microsoft Copilot';
                alert(`✅ Prompt copiado al portapapeles\n\nAhora:\n1. Vaya a la pestaña de ${nombreIA}\n2. Pegue con Ctrl+V\n3. ¡Listo para usar!`);
                
                cerrarModalIA();
            });
        }

        function generarPromptExternoCompleto(semanaIndex) {
            const nivel = document.getElementById('nivel').value;
            const ciclo = document.getElementById('ciclo').value;
            const areasSeleccionadas = Array.from(document.querySelectorAll('input[name="area"]:checked')).map(cb => getAreaName(cb.value));
            const ejesTransversales = Array.from(document.querySelectorAll('input[name="eje"]:checked')).map(cb => {
                const labels = {
                    'ciudadania': 'Ciudadanía y ética digital',
                    'pensamiento': 'Pensamiento computacional para la resolución de problemas',
                    'emprendimiento': 'Emprendimiento e Innovación'
                };
                return labels[cb.value] || cb.value;
            });
            
            const metodologia = document.getElementById('metodologiaActiva').value;
            const metodologiaOtra = document.getElementById('metodologiaOtra').value;
            const metodologiaFinal = metodologia === 'otra' ? metodologiaOtra : 
                                    document.querySelector(`#metodologiaActiva option[value="${metodologia}"]`)?.textContent || 'No especificado';
            
            // Obtener saberes conceptuales seleccionados para esta semana
            const semana = document.querySelector(`.semana-item[data-semana-index="${semanaIndex}"]`);
            const saberesConceptuales = Array.from(semana.querySelectorAll(`input[name="saberConceptualSemana${semanaIndex}"]:checked`)).map(cb => cb.value);
            const saberesManuales = Array.from(semana.querySelectorAll(`input[name="saberManualSemana${semanaIndex}"]:checked`)).map(cb => cb.value);
            const todosSaberes = [...saberesConceptuales, ...saberesManuales];
            
            // Obtener indicadores de logro REALES de la base de datos
            const indicadoresLogro = obtenerIndicadoresLogroReales(nivel, areasSeleccionadas, saberesConceptuales);
            
            // Obtener saberes procedimentales y actitudinales seleccionados
            const saberesProcedimentales = Array.from(document.querySelectorAll('input[name="procedimental"]:checked')).map(cb => {
                const labels = {
                    'reconoce': 'Reconoce patrones',
                    'abstrae': 'Abstrae',
                    'generaliza': 'Generaliza',
                    'transfiere': 'Transfiere',
                    'modulariza': 'Modulariza',
                    'formula': 'Formula algoritmos',
                    'remezcla': 'Remezcla',
                    'depura': 'Depura',
                    'programa': 'Programa',
                    'comunica': 'Comunica',
                    'colabora': 'Colabora',
                    'piensa': 'Piensa de forma creativa',
                    'maneja': 'Maneja las tecnologías de forma ética y segura'
                };
                return labels[cb.value] || cb.value;
            });
            
            const saberesActitudinales = Array.from(document.querySelectorAll('input[name="actitudinal"]:checked')).map(cb => {
                const labels = {
                    'gusto': 'Gusto por la precisión',
                    'aprender': 'Aprender del error',
                    'flexibilidad': 'Flexibilidad para manejar problemas',
                    'tolerancia': 'Tolerancia a la frustración'
                };
                return labels[cb.value] || cb.value;
            });
            
            const indicadoresEvaluacion = "No especificado";
            
            return `Diseña una actividad PNFT para el ciclo ${ciclo || "No especificado"}, nivel ${nivel || "No especificado"} en las áreas de conocimiento: ${areasSeleccionadas.join(', ') || "No especificado"}, con los ejes transversales (elegidos por el docente): ${ejesTransversales.join(', ') || "No especificado"}

Saberes conceptuales: ${todosSaberes.join(', ') || "No especificado"}

Indicadores de logro (automáticos por el sistema mediante los saberes conceptuales que eligió el docente):
${indicadoresLogro.map(ind => `• ${ind}`).join('\n')}

Indicadores de evaluación (personalizados): ${indicadoresEvaluacion}

Saberes procedimentales: ${saberesProcedimentales.join(', ') || "No especificado"}

Saberes actitudinales: ${saberesActitudinales.join(', ') || "No especificado"}

Metodología elegida: ${metodologiaFinal || "No especificado"}

Componente de evaluación según reglamento y lineamientos del MEP: El docente puede en algún momento solicitar que la actividad o sugerencia sea para tareas, pruebas, trabajo cotidiano o proyecto en caso de secundaria.

Tema ( En caso que el docente especifique algún tema qué desarrollará adicional con los saberes conceptuales o si es proyecto en secundaria o es para tarea, prueba o trabajo cotidiano): No especificado

Duración: 40-80 min. (1 o 2 lecciones), o bien por semanas que eligió el docente.

Estructura: competencia (articulación de los saberes conceptuales), secuencia de la actividad (inicio, desarrollo, cierre), sugerencias de evaluación según instrumentos del MEP.

Proporciona una actividad completa que integre todos estos elementos de manera coherente y alineada con el currículo del PNFT.`;
        }

        function obtenerIndicadoresLogroReales(nivel, areasSeleccionadas, saberesConceptuales) {
            if (!nivel || !areasSeleccionadas || areasSeleccionadas.length === 0 || !saberesConceptuales || saberesConceptuales.length === 0) {
                return ["No especificado"];
            }
            
            const indicadores = [];
            const nivelData = PNFT_DATA[nivel];
            
            if (!nivelData) {
                return ["No hay datos para este nivel"];
            }
            
            // Buscar indicadores para cada saber conceptual seleccionado
            saberesConceptuales.forEach(saberNombre => {
                areasSeleccionadas.forEach(areaNombre => {
                    const areaData = nivelData[areaNombre];
                    if (areaData && areaData.saberes) {
                        const saberEncontrado = areaData.saberes.find(s => s.nombre === saberNombre);
                        if (saberEncontrado && saberEncontrado.indicadores) {
                            indicadores.push(...saberEncontrado.indicadores);
                        }
                    }
                });
            });
            
            // Si no se encontraron indicadores, buscar en todas las áreas
            if (indicadores.length === 0) {
                Object.values(nivelData).forEach(areaData => {
                    if (areaData && areaData.saberes) {
                        const saberEncontrado = areaData.saberes.find(s => s.nombre === saberesConceptuales[0]);
                        if (saberEncontrado && saberEncontrado.indicadores) {
                            indicadores.push(...saberEncontrado.indicadores);
                        }
                    }
                });
            }
            
            return indicadores.length > 0 ? indicadores : ["No se encontraron indicadores para los saberes seleccionados"];
        }

        function cerrarModalIA() {
            const modal = document.getElementById('selectorIAModal');
            if (modal) {
                modal.remove();
            }
        }

        // ===== SISTEMA DE EXPANSIÓN =====
        function toggleExpansion(button) {
            const col = button.closest('.semana-col');
            const contenedor = col.querySelector('.contenedor-editable');
            contenedor.style.minHeight = contenedor.style.minHeight === '400px' ? '150px' : '400px';
            
            if (contenedor.style.minHeight === '400px') {
                button.textContent = '−';
                button.title = 'Contraer';
            } else {
                button.textContent = '+';
                button.title = 'Expandir';
            }
        }

        // ===== FUNCIONES AUXILIARES =====
        function getAreaName(areaKey) {
            const areas = {
                'apropiacion': 'Apropiación tecnológica y Digital',
                'programacion': 'Programación y Algoritmos', 
                'robotica': 'Computación física y Robótica',
                'ciencia': 'Ciencia de datos e Inteligencia artificial'
            };
            return areas[areaKey] || areaKey;
        }

        function recopilarDatosPlan() {
            const datos = {
                direccionRegional: document.getElementById('direccionRegional').value,
                centroEducativo: document.getElementById('centroEducativo').value,
                codigoCentro: document.getElementById('codigoCentro').value,
                nombreDocente: document.getElementById('nombreDocente').value,
                ciclo: document.getElementById('ciclo').value,
                nivel: document.getElementById('nivel').value,
                leccionesPlanificadas: document.getElementById('leccionesPlanificadas').value,
                mesInicio: document.getElementById('mesInicio').value,
                mesFinal: document.getElementById('mesFinal').value,
                periodicidad: document.querySelector('input[name="periodicidad"]:checked')?.value,
                ejesTransversales: Array.from(document.querySelectorAll('input[name="eje"]:checked')).map(cb => cb.value),
                metodologiaActiva: document.getElementById('metodologiaActiva').value,
                metodologiaOtra: document.getElementById('metodologiaOtra').value,
                areasConocimiento: Array.from(document.querySelectorAll('input[name="area"]:checked')).map(cb => cb.value),
                saberesManuales: document.getElementById('saberesManuales').value,
                saberesProcedimentales: Array.from(document.querySelectorAll('input[name="procedimental"]:checked')).map(cb => cb.value),
                saberesActitudinales: Array.from(document.querySelectorAll('input[name="actitudinal"]:checked')).map(cb => cb.value),
                queFunciono: document.getElementById('queFunciono').value,
                queNoFunciono: document.getElementById('queNoFunciono').value,
                queMejorar: document.getElementById('queMejorar').value,
                observaciones: document.getElementById('observaciones').value,
                saberesSeleccionadosGlobal: Array.from(saberesSeleccionadosGlobal), // MEJORA: Guardar saberes globales
                semanas: []
            };
            
            document.querySelectorAll('.semana-item').forEach((semana, index) => {
                const contenedores = semana.querySelectorAll('.contenedor-editable');
                const datosSemana = {
                    nombre: semana.querySelector('.semana-nombre').value,
                    lecciones: semana.querySelector('.lecciones-contador')?.textContent || '4', // MEJORA 2: Valor por defecto
                    indicadoresLogro: contenedores[0]?.innerHTML || '',
                    estrategiasMediacion: contenedores[1]?.innerHTML || '',
                    indicadorEvaluacion: contenedores[2]?.innerHTML || '',
                    saberesConceptuales: Array.from(semana.querySelectorAll(`input[name="saberConceptualSemana${index}"]:checked`)).map(cb => cb.value),
                    saberesManuales: Array.from(semana.querySelectorAll(`input[name="saberManualSemana${index}"]:checked`)).map(cb => cb.value)
                };
                datos.semanas.push(datosSemana);
            });
            
            return datos;
        }

        function cargarDatosSemanasGuardados(plan = null) {
            if (!plan) {
                const datosGuardados = localStorage.getItem('planActual');
                if (datosGuardados) {
                    plan = JSON.parse(datosGuardados);
                } else {
                    return;
                }
            }
            
            // MEJORA: Cargar saberes seleccionados globales
            if (plan.saberesSeleccionadosGlobal) {
                saberesSeleccionadosGlobal = new Set(plan.saberesSeleccionadosGlobal);
                actualizarSaberesSeleccionadosDisplay();
            }
            
            if (plan.semanas) {
                plan.semanas.forEach((semanaData, index) => {
                    const semanaElement = document.querySelector(`.semana-item[data-semana-index="${index}"]`);
                    if (semanaElement) {
                        if (semanaData.nombre) semanaElement.querySelector('.semana-nombre').value = semanaData.nombre;
                        
                        const contenedores = semanaElement.querySelectorAll('.contenedor-editable');
                        if (semanaData.indicadoresLogro && contenedores[0]) contenedores[0].innerHTML = semanaData.indicadoresLogro;
                        if (semanaData.estrategiasMediacion && contenedores[1]) contenedores[1].innerHTML = semanaData.estrategiasMediacion;
                        if (semanaData.indicadorEvaluacion && contenedores[2]) contenedores[2].innerHTML = semanaData.indicadorEvaluacion;
                        
                        if (semanaData.saberesConceptuales) {
                            semanaData.saberesConceptuales.forEach(saber => {
                                const checkbox = semanaElement.querySelector(`input[name="saberConceptualSemana${index}"][value="${saber}"]`);
                                if (checkbox) {
                                    checkbox.checked = true;
                                    saberesSeleccionadosGlobal.add(saber);
                                }
                            });
                        }
                        
                        if (semanaData.saberesManuales) {
                            semanaData.saberesManuales.forEach(saber => {
                                const checkbox = semanaElement.querySelector(`input[name="saberManualSemana${index}"][value="${saber}"]`);
                                if (checkbox) {
                                    checkbox.checked = true;
                                    saberesSeleccionadosGlobal.add(saber);
                                }
                            });
                        }
                        
                        actualizarIndicadoresLogroDesdeDatos(semanaElement, index);
                    }
                });
                
                // Actualizar display después de cargar todos los datos
                actualizarSaberesSeleccionadosDisplay();
            }
        }

        function actualizarIndicadoresLogroDesdeDatos(semanaElement, index) {
            const contenedor = semanaElement.querySelector('.contenedor-editable[contenteditable="false"]');
            const saberesSeleccionados = Array.from(semanaElement.querySelectorAll(`input[name="saberConceptualSemana${index}"]:checked`));
            const saberesManualesSeleccionados = Array.from(semanaElement.querySelectorAll(`input[name="saberManualSemana${index}"]:checked`));
            
            let indicadores = [];
            
            saberesSeleccionados.forEach(cb => {
                try {
                    const indicadoresSaber = JSON.parse(cb.getAttribute('data-indicadores') || '[]');
                    indicadores = indicadores.concat(indicadoresSaber);
                } catch (error) {
                    console.error("Error parseando indicadores:", error);
                }
            });

           saberesManualesSeleccionados.forEach(cb => {
                indicadores.push(`Aplica el concepto de "${cb.value}" en situaciones prácticas del contexto educativo.`);
            });
            
            if (contenedor) {
                if (indicadores.length > 0) {
                    contenedor.innerHTML = `<ul class="indicadores-lista">${indicadores.map(ind => `<li>${ind}</li>`).join('')}</ul>`;
                } else {
                    contenedor.innerHTML = "Seleccione al menos dos saberes conceptuales para esta semana.";
                }
            }
        }

        function reindexarSemanas() {
            document.querySelectorAll('.semana-item').forEach((semana, index) => {
                semana.setAttribute('data-semana-index', index);
                
                const saberesConceptuales = semana.querySelectorAll(`input[name^="saberConceptualSemana"]`);
                saberesConceptuales.forEach(input => {
                    input.name = `saberConceptualSemana${index}`;
                    input.setAttribute('data-semana-index', index);
                });
                
                const saberesManuales = semana.querySelectorAll(`input[name^="saberManualSemana"]`);
                saberesManuales.forEach(input => {
                    input.name = `saberManualSemana${index}`;
                    input.setAttribute('data-semana-index', index);
                });
            });
        }

        // ===== FUNCIONES DE GUARDADO Y CARGA =====
        function guardarPlan() {
            const nivel = document.getElementById('nivel').value;
            const areasSeleccionadas = Array.from(document.querySelectorAll('input[name="area"]:checked'));
            
            if (!nivel || areasSeleccionadas.length === 0) {
                alert('❌ Para guardar un plan, debe seleccionar al menos un nivel y un área de conocimiento');
                return;
            }
            
            document.getElementById('nombrePlan').value = generarNombreSugerido();
            document.getElementById('guardarModal').style.display = 'block';
        }

        function cargarPlan() {
            mostrarPlanesGuardados();
            document.getElementById('cargarModal').style.display = 'block';
        }

        function confirmarGuardar() {
            const nombre = document.getElementById('nombrePlan').value.trim();
            if (!nombre) {
                alert('❌ Por favor ingrese un nombre para el plan');
                return;
            }

            const plan = recopilarDatosPlan();
            plan.id = Date.now();
            plan.fechaCreacion = new Date().toISOString();
            plan.nombre = nombre;

            const indiceExistente = planesGuardados.findIndex(p => p.nombre === nombre);
            if (indiceExistente !== -1) {
                if (confirm('⚠️ Ya existe un plan con ese nombre. ¿Desea reemplazarlo?')) {
                    planesGuardados[indiceExistente] = plan;
                } else {
                    return;
                }
            } else {
                planesGuardados.push(plan);
            }

            localStorage.setItem('planesDidacticos', JSON.stringify(planesGuardados));
            cerrarModal();
            alert(`✅ Plan "${nombre}" guardado exitosamente!`);
        }

        function confirmarCargar() {
            if (!planSeleccionado) {
                alert('❌ Por favor seleccione un plan de la lista');
                return;
            }

            const plan = planesGuardados.find(p => p.id === planSeleccionado);
            if (plan) {
                cargarDatosPlan(plan);
                cerrarModal();
                alert(`✅ Plan "${plan.nombre}" cargado correctamente`);
            }
        }

        function mostrarPlanesGuardados() {
            const lista = document.getElementById('listaPlanes');
            
            if (planesGuardados.length === 0) {
                lista.innerHTML = '<div class="saberes-info">No hay planes guardados</div>';
                return;
            }

            lista.innerHTML = planesGuardados.map(plan => `
                <div class="plan-item" onclick="seleccionarPlan(${plan.id})" data-plan-id="${plan.id}">
                    <strong>${plan.nombre}</strong>
                    <div class="plan-details">
                        <span>Nivel: ${plan.nivel || 'No especificado'}</span>
                        <span>${new Date(plan.fechaCreacion).toLocaleDateString()}</span>
                    </div>
                </div>
            `).join('');
        }

        function seleccionarPlan(planId) {
            document.querySelectorAll('.plan-item').forEach(item => {
                item.classList.remove('selected');
            });
            document.querySelector(`[data-plan-id="${planId}"]`).classList.add('selected');
            planSeleccionado = planId;
        }

        function cargarDatosPlan(plan) {
            if (plan.direccionRegional) document.getElementById('direccionRegional').value = plan.direccionRegional;
            if (plan.centroEducativo) document.getElementById('centroEducativo').value = plan.centroEducativo;
            if (plan.codigoCentro) document.getElementById('codigoCentro').value = plan.codigoCentro;
            if (plan.nombreDocente) document.getElementById('nombreDocente').value = plan.nombreDocente;
            if (plan.ciclo) document.getElementById('ciclo').value = plan.ciclo;
            if (plan.nivel) document.getElementById('nivel').value = plan.nivel;
            if (plan.leccionesPlanificadas) {
                document.getElementById('leccionesPlanificadas').value = plan.leccionesPlanificadas;
                document.getElementById('totalLecciones').textContent = plan.leccionesPlanificadas;
            }
            if (plan.mesInicio) document.getElementById('mesInicio').value = plan.mesInicio;
            if (plan.mesFinal) document.getElementById('mesFinal').value = plan.mesFinal;
            if (plan.periodicidad) {
                document.querySelector(`input[name="periodicidad"][value="${plan.periodicidad}"]`).checked = true;
            }
            
            if (plan.ejesTransversales) {
                document.querySelectorAll('input[name="eje"]').forEach(checkbox => {
                    checkbox.checked = plan.ejesTransversales.includes(checkbox.value);
                    checkbox.closest('.eje-option').classList.toggle('selected', checkbox.checked);
                });
            }
            
            if (plan.metodologiaActiva) {
                document.getElementById('metodologiaActiva').value = plan.metodologiaActiva;
                if (plan.metodologiaActiva === 'otra' && plan.metodologiaOtra) {
                    document.getElementById('metodologiaOtra').value = plan.metodologiaOtra;
                    document.getElementById('metodologiaOtra').style.display = 'block';
                }
            }
            
            if (plan.areasConocimiento) {
                document.querySelectorAll('input[name="area"]').forEach(checkbox => {
                    checkbox.checked = plan.areasConocimiento.includes(checkbox.value);
                });
            }
            
            if (plan.saberesManuales) document.getElementById('saberesManuales').value = plan.saberesManuales;
            if (plan.saberesProcedimentales) {
                document.querySelectorAll('input[name="procedimental"]').forEach(checkbox => {
                    checkbox.checked = plan.saberesProcedimentales.includes(checkbox.value);
                });
            }
            if (plan.saberesActitudinales) {
                document.querySelectorAll('input[name="actitudinal"]').forEach(checkbox => {
                    checkbox.checked = plan.saberesActitudinales.includes(checkbox.value);
                });
            }
            
            if (plan.queFunciono) document.getElementById('queFunciono').value = plan.queFunciono;
            if (plan.queNoFunciono) document.getElementById('queNoFunciono').value = plan.queNoFunciono;
            if (plan.queMejorar) document.getElementById('queMejorar').value = plan.queMejorar;
            if (plan.observaciones) document.getElementById('observaciones').value = plan.observaciones;
            
            actualizarRda();
            generarSemanas();
            
            setTimeout(() => {
                cargarDatosSemanasGuardados(plan);
            }, 100);
        }

        function generarNombreSugerido() {
            const nivel = document.getElementById('nivel').value || 'Nivel';
            const ciclo = document.getElementById('ciclo').value || 'Ciclo';
            const fecha = new Date().toLocaleDateString();
            return `${nivel} - ${ciclo} - ${fecha}`;
        }

        function cerrarModal() {
            document.getElementById('guardarModal').style.display = 'none';
            document.getElementById('cargarModal').style.display = 'none';
            planSeleccionado = null;
        }

        function exportarPDF() {
            window.print();
        }

        function exportarPlan() {
            const plan = recopilarDatosPlan();
            const datosExportar = {
                ...plan,
                fechaExportacion: new Date().toISOString(),
                version: '1.0'
            };
            
            const blob = new Blob([JSON.stringify(datosExportar, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `planeamiento-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ Plan exportado correctamente. Guarde el archivo en su disco duro o USB.');
        }

        function importarPlan() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const plan = JSON.parse(e.target.result);
                            cargarDatosPlan(plan);
                            alert('✅ Plan importado correctamente');
                        } catch (error) {
                            alert('❌ Error al importar el plan: Archivo inválido');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function nuevoPlan() {
            if (confirm('¿Está seguro de que desea crear un nuevo plan? Se perderán los cambios no guardados.')) {
                localStorage.removeItem('planActual');
                location.reload();
            }
        }

        // Cerrar modales al hacer click fuera
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target == modal) {
                    cerrarModal();
                }
            }
        }
    </script>
   <!-- Contenedor para el avatar secreto -->
<div id="avatar-secreto" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10000; text-align: center; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
    <img src="https://i.imgur.com/Pal4LtF.png" alt="Avatar de Kevin Sánchez" style="width: 150px; height: 150px; border-radius: 50%; margin-bottom: 15px;">
    <p style="font-weight: bold; color: var(--primary-color);">MSc. Kevin Sánchez Bogarín<br>Asesor Nacional PNFT</p>
    <button onclick="cerrarAvatar()" style="margin-top: 10px; padding: 8px 16px; background: var(--primary-color); color: white; border: none; border-radius: 6px; cursor: pointer;">Cerrar</button>
</div>

<script>
    let clics = 0;
    let ultimoClic = 0;

    // Selecciona el título del encabezado
    const titulo = document.getElementById('titulo-secreto');

    titulo.addEventListener('click', function(e) {
        e.stopPropagation(); // Evita que el click se propague
        const ahora = Date.now();

        // Reinicia el contador si pasaron más de 1 segundo entre clics
        if (ahora - ultimoClic > 1000) {
            clics = 0;
        }

        clics++;
        ultimoClic = ahora;

        // Si se hacen 3 clics rápidos (o más), activa el avatar
        if (clics >= 3) {
            mostrarAvatar();
            clics = 0; // Reinicia el contador
        }
    });

    function mostrarAvatar() {
        const avatarDiv = document.getElementById('avatar-secreto');
        avatarDiv.style.display = 'block';
    }

    function cerrarAvatar() {
        const avatarDiv = document.getElementById('avatar-secreto');
        avatarDiv.style.display = 'none';
    }

    // Opcional: Cerrar avatar si se hace clic fuera de él
    document.addEventListener('click', function(e) {
        const avatarDiv = document.getElementById('avatar-secreto');
        if (avatarDiv.style.display === 'block' && !avatarDiv.contains(e.target)) {
            cerrarAvatar();
        }
    });
</script> 
</body>
</html>
